<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>Jmsp&#39;s Tips</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Jmsp's Tips">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Jmsp's Tips">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jmsp's Tips">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Jmsp&#39;s Tips" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/main.css" type="text/css">
  
<!-- baidu Analytics -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d400b2b9cf7d1a287b60931c6cbae186";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!-- End baidu Analytics -->


</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="http://7xoz39.com1.z0.glb.clouddn.com/BLOG_IMG_0412.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Jmsp</a></h1>
		</hgroup>

		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">ä¸»é¡µ</a></li>
	        
				<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
	        
				<li><a href="/categories/OC">OC</a></li>
	        
				<li><a href="/categories/Swift">Swift</a></li>
	        
				<li><a href="/categories/Android">Android</a></li>
	        
				<li><a href="/categories/ReactNative">ReactNative</a></li>
	        
				<li><a href="/categories/PHP">PHP</a></li>
	        
				<li><a href="/categories/Python">Python</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
            
    			
            
    			
            
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/zhangzhaopds weibo: " title="github">github</a>
		        
					<a class="rss" target="_blank" href="/#" title="rss">rss</a>
		        
					<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Jmsp</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="http://7xoz39.com1.z0.glb.clouddn.com/BLOG_IMG_0412.png" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Jmsp</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
					<li><a href="/categories/OC">OC</a></li>
		        
					<li><a href="/categories/Swift">Swift</a></li>
		        
					<li><a href="/categories/Android">Android</a></li>
		        
					<li><a href="/categories/ReactNative">ReactNative</a></li>
		        
					<li><a href="/categories/PHP">PHP</a></li>
		        
					<li><a href="/categories/Python">Python</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/zhangzhaopds weibo: " title="github">github</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-iOSä¸­çš„OTAéƒ¨ç½²" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/26/iOSä¸­çš„OTAéƒ¨ç½²/">OTAéƒ¨ç½²</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>åˆ©ç”¨<code>XC Ad Hoc: *</code>ç±»å‹çš„Provisioning Profileæ‰“åŒ…ipaæ–‡ä»¶ï¼Œå¹¶éƒ¨ç½²åˆ°HTTPSçš„å±€åŸŸç½‘å†…ï¼Œæä¾›å†…éƒ¨äººå‘˜ä¸‹è½½å®‰è£…ã€‚</p>
</blockquote>
<h4 id="å†…ç½‘ä¸­HTTPSç¯å¢ƒæ­å»º"><a href="#å†…ç½‘ä¸­HTTPSç¯å¢ƒæ­å»º" class="headerlink" title="å†…ç½‘ä¸­HTTPSç¯å¢ƒæ­å»º"></a>å†…ç½‘ä¸­HTTPSç¯å¢ƒæ­å»º</h4><p><a href="http://zhangzhaopds.github.io/2016/12/26/Macä¸­å¼€å¯Apacheçš„HttpsåŠŸèƒ½/" target="_blank" rel="external">http://zhangzhaopds.github.io/2016/12/26/Macä¸­å¼€å¯Apacheçš„HttpsåŠŸèƒ½/</a></p>
<h4 id="OTAå…·ä½“éƒ¨ç½²"><a href="#OTAå…·ä½“éƒ¨ç½²" class="headerlink" title="OTAå…·ä½“éƒ¨ç½²"></a>OTAå…·ä½“éƒ¨ç½²</h4><p><a href="http://www.jianshu.com/p/bd016015efe7" target="_blank" rel="external">http://www.jianshu.com/p/bd016015efe7</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/26/iOSä¸­çš„OTAéƒ¨ç½²/" class="archive-article-date">
  	<time datetime="2016-12-26T06:28:47.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-26</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OTAéƒ¨ç½²/">OTAéƒ¨ç½²</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Macä¸­å¼€å¯Apacheçš„HttpsåŠŸèƒ½" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/26/Macä¸­å¼€å¯Apacheçš„HttpsåŠŸèƒ½/">Macä¸­å¼€å¯Apacheçš„HttpsåŠŸèƒ½</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ä¸ºMacä¸­è‡ªå¸¦çš„Apacheå¼€å¯HttpsåŠŸèƒ½ï¼Œè¯ä¹¦æ˜¯è‡ªç­¾åçš„è¯ä¹¦ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹å†…å®¹æ˜¯é’ˆå¯¹å·²ç»é…ç½®è¿‡Apacheï¼Œèƒ½å¤Ÿåˆ©ç”¨ <a href="http://localhost/" target="_blank" rel="external">http://localhost</a>æ‰“å¼€ç½‘é¡µçš„åŸºç¡€ä¸Šçš„è®¾ç½®ã€‚</p>
<h4 id="é…ç½®SSL"><a href="#é…ç½®SSL" class="headerlink" title="é…ç½®SSL"></a>é…ç½®SSL</h4><p>åœ¨ç»ˆç«¯åˆ›å»ºSSLè·¯å¾„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /etc/apache2/ssl</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥åˆ›å»ºä¸€ä¸ªç§é’¥keyå’Œè¯ä¹¦</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo openssl genrsa -out /etc/apache2/ssl/server.key <span class="number">2048</span></span><br><span class="line">sudo openssl req -<span class="keyword">new</span> -x509 -key /etc/apache2/ssl/server.key -out /etc/apache2/ssl/server.crt -days <span class="number">3650</span> -subj /CN=localhost</span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œæ·»åŠ è¯ä¹¦åˆ°é’¥åŒ™ä¸²å¹¶ä¿¡ä»»æ”¹è¯ä¹¦</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /etc/apache2/ssl/server.crt</span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®SSLè™šæ‹Ÿä¸»æœº"><a href="#é…ç½®SSLè™šæ‹Ÿä¸»æœº" class="headerlink" title="é…ç½®SSLè™šæ‹Ÿä¸»æœº"></a>é…ç½®SSLè™šæ‹Ÿä¸»æœº</h4><h5 id="1ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd-conf"><a href="#1ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd-conf" class="headerlink" title="1ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd.conf"></a>1ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd.conf</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apache2/httpd.conf</span><br></pre></td></tr></table></figure>
<p>æ‰¾åˆ°ä¸‹é¢ä¸‰è¡Œï¼Œ åœ¨è‹±æ–‡è¾“å…¥çŠ¶æ€ä¸‹ï¼Œç‚¹å‡»<code>i</code>,è¿›å…¥ç¼–è¾‘çŠ¶æ€ï¼Œå¹¶å°†å‰é¢çš„ <code>#</code> å»æ‰ï¼Œå»æ‰#ä¹‹åï¼Œ<code>control+c</code>é€€å‡ºç¼–è¾‘ï¼Œå†æ‰§è¡Œ<code>:wq</code>å›åˆ°ç»ˆç«¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LoadModule socache_shmcb_module libexec/apache2/mod_socache_shmcb.so</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LoadModule ssl_module libexec/apache2/mod_ssl.so</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Include /<span class="keyword">private</span>/etc/apache2/extra/httpd-ssl.conf</span><br></pre></td></tr></table></figure>
<h5 id="2ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd-vhosts-conf"><a href="#2ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd-vhosts-conf" class="headerlink" title="2ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd-vhosts.conf"></a>2ã€åœ¨ç»ˆç«¯ï¼Œç¼–è¾‘httpd-vhosts.conf</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apache2/extra/httpd-vhosts.conf</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ç«¯å£443çš„è™šæ‹Ÿä¸»æœº</p>
<p><strong>æ³¨æ„ï¼š</strong> <code>ServerName</code> å­—æ®µè¦å’Œ .crtè¯ä¹¦ç”Ÿæˆæ—¶çš„<code>CN</code>ï¼ˆCommonNameï¼‰å­—æ®µç›¸ä¸€è‡´ï¼ˆå¯ä»¥æ˜¯åŸŸåï¼Œä¹Ÿå¯ä»¥æ˜¯IPï¼Œå»ºè®®ç”¨IPï¼‰ï¼Œå³æœ¬ä¾‹ä¸­çš„ <code>ServerName localhost</code>ä¸<code>CN=localhost</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;VirtualHost *:443&gt;</span></span><br><span class="line">    <span class="keyword"><span class="common">ServerName</span></span> localhost</span><br><span class="line">    <span class="keyword"><span class="common">DocumentRoot</span></span> <span class="string">"/Users/indieweb/Sites/localhost"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">SSLEngine</span> <span class="literal">on</span></span><br><span class="line">    <span class="keyword">SSLCipherSuite</span> <span class="literal">ALL</span>:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL</span><br><span class="line">    <span class="keyword">SSLCertificateFile</span> /etc/apache2/ssl/server.crt</span><br><span class="line">    <span class="keyword">SSLCertificateKeyFile</span> /etc/apache2/ssl/server.key</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;Directory "/Users/indieweb/Sites/localhost"&gt;</span></span><br><span class="line">        <span class="keyword"><span class="common">Options</span></span> Indexes FollowSymLinks</span><br><span class="line">        <span class="keyword">AllowOverride</span> <span class="literal">All</span></span><br><span class="line">        <span class="keyword"><span class="common">Order</span></span> allow,deny</span><br><span class="line">        <span class="keyword"><span class="common">Allow</span></span> from <span class="literal">all</span></span><br><span class="line">        <span class="keyword">Require</span> <span class="literal">all</span> granted</span><br><span class="line">    <span class="tag">&lt;/Directory&gt;</span></span><br><span class="line"><span class="tag">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure>
<p>å›åˆ°ç»ˆç«¯ï¼Œæ‰§è¡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apache2/extra/httpd-vhosts.conf</span><br></pre></td></tr></table></figure>
<p>é…ç½®<code>SSLCertificateFile</code>å’Œ<code>SSLCertificateKeyFile</code>æ–‡ä»¶è·¯å¾„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SSLCertificateFile <span class="string">"/etc/apache2/ssl/server.crt"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SSLCertificateKeyFile <span class="string">"/etc/apache2/ssl/server.key"</span></span><br></pre></td></tr></table></figure>
<p>å›åˆ°ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œå¦‚æœå‡ºç°<code>Syntax OK</code>ï¼Œåˆ™ä»£è¡¨é…ç½®æˆåŠŸ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl configtest</span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œé‡å¯Apache</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl restart</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€  <a href="https://localhost" target="_blank" rel="external">https://localhost</a> </p>
<p>åˆ°æ­¤å°±å®Œæˆé…ç½®äº†ã€‚</p>
<h4 id="å±€åŸŸç½‘å†…çš„HTTPSé…ç½®"><a href="#å±€åŸŸç½‘å†…çš„HTTPSé…ç½®" class="headerlink" title="å±€åŸŸç½‘å†…çš„HTTPSé…ç½®"></a>å±€åŸŸç½‘å†…çš„HTTPSé…ç½®</h4><p>å¦‚æœæƒ³è®©å±€åŸŸç½‘å†…çš„å…¶ä»–æµè§ˆå™¨æ‰“å¼€ä½ çš„ç½‘é¡µï¼Œåˆ™éœ€è¦å°† ServerNameå’ŒCommonNameè®¾ç½®æˆä½ çš„ç”µè„‘çš„IPï¼Œå½“ç„¶è¯ä¹¦éƒ½éœ€è¦é‡æ–°ç”Ÿæˆå¹¶æ›¿æ¢ï¼›</p>
<p>åŒæ—¶è®¿é—®åœ°å€å˜ä¸ºï¼š<a href="https://ä½ çš„ipåœ°å€" target="_blank" rel="external">https://ä½ çš„ipåœ°å€</a></p>
<p><strong>æ³¨æ„ï¼š</strong>è¦æƒ³åœ¨iPhoneçš„Safariä¸­è®¿é—®è¿™ä¸ªç«™ç‚¹ï¼Œé¦–å…ˆServerNameå’ŒCommonNameä¸€å®šæ˜¯IPåœ°å€ï¼Œå…¶æ¬¡æ‰‹æœºè¦äº‹å…ˆå®‰è£…ä½ ç”Ÿæˆçš„<code>server.crt</code>è¯ä¹¦ï¼Œä¸ç„¶Safariä¼šä¸€ç›´å¤„äºå°è¯•è®¿é—®è¿™ä¸ªçš„ç«™ç‚¹çš„çŠ¶æ€ï¼Œå³ä¸€é—ªä¸€é—ªçš„ç°è±¡ã€‚</p>
<h4 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h4><p><a href="https://gist.github.com/jonathantneal/774e4b0b3d4d739cbc53" target="_blank" rel="external">https://gist.github.com/jonathantneal/774e4b0b3d4d739cbc53</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/26/Macä¸­å¼€å¯Apacheçš„HttpsåŠŸèƒ½/" class="archive-article-date">
  	<time datetime="2016-12-26T05:22:26.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-26</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Apache/">Apache</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Https/">Https</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/PHP/">PHP</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-escaping" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/23/escaping/">@escaping</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Swiftä¸­çš„é€ƒé€¸é—­åŒ…ï¼ˆescape closureï¼‰ã€‚</p>
</blockquote>
<h4 id="é€ƒé€¸é—­åŒ…"><a href="#é€ƒé€¸é—­åŒ…" class="headerlink" title="é€ƒé€¸é—­åŒ…"></a>é€ƒé€¸é—­åŒ…</h4><p>â€‹    å½“ä¸€ä¸ªä¼ å…¥å‡½æ•°çš„é—­åŒ…åœ¨å‡½æ•°æ‰§è¡Œç»“æŸä¹‹åæ‰ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ ·çš„é—­åŒ…å°±å«åšé€ƒé€¸é—­åŒ…ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°çš„å‚æ•°æœ‰ä¸€ä¸ªé€ƒé€¸é—­åŒ…ï¼Œå¯ä»¥åœ¨å‚æ•°å‰åŠ @escapingå…³é”®å­—æ¥ä¿®é¥°ã€‚</p>
<p>â€‹    ä¸€ä¸ªé—­åŒ…æ˜¯é€ƒé€¸å¿…è¦çš„æ¡ä»¶æ˜¯è¿™ä¸ªé—­åŒ…éœ€è¦å­˜å‚¨åœ¨å‡½æ•°å¤–éƒ¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¾ˆå¤šå¼‚æ­¥æ“ä½œçš„å‡½æ•°å¾€å¾€ä¼šä¼ å…¥ä¸€ä¸ªcomplete handlerä½œä¸ºå¼‚æ­¥æ“ä½œå®Œæˆåçš„å›è°ƒã€‚å½“è¿™ä¸ªå¼‚æ­¥å‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šå¼€å¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œç„¶åè¿™ä¸ªå‡½æ•°å°±ç›´æ¥ç»“æŸäº†ï¼Œæ­¤æ—¶ï¼Œä¼ å…¥çš„é—­åŒ…è¿˜æ²¡æœ‰è¢«æ‰§è¡Œï¼Œå®é™…ä¸Šè¿™ä¸ªå›è°ƒéœ€è¦åœ¨å¼‚æ­¥æ“ä½œå®Œæˆåæ‰ä¼šè¢«æ‰§è¡Œã€‚è¿™ç§æƒ…å†µä¸‹è¿™ä¸ªå›è°ƒçš„é—­åŒ…éœ€è¦å®šä¹‰æˆé€ƒé€¸é—­åŒ…ï¼Œå› ä¸ºå®ƒåœ¨å‡½æ•°è°ƒç”¨ç»“æŸä¹‹åæ‰ä¼šè¢«æ‰§è¡Œã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š    </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> completionHandlers: [() -&gt; <span class="type">Void</span>] = []</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">someFunctionWithEscapingClosure</span><span class="params">(completionHandler: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    completionHandlers.append(completionHandler)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€‹    someFunctionWithEscapingClosureä»¥ä¸€ä¸ªcompletionHandlerä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä¼šè¢«ä¿å­˜åœ¨å‡½æ•°å¤–éƒ¨çš„completionHandlersæ•°ç»„ä¸­ï¼Œè¿™æ—¶è¿™ä¸ªé—­åŒ…æ˜¯ä¸€ä¸ªé€ƒé€¸é—­åŒ…ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ @escapingå…³é”®å­—å»ä¿®é¥°ï¼Œå¦åˆ™ä¼šæœ‰ç¼–è¯‘é”™è¯¯ã€‚</p>
<p>â€‹    é€ƒé€¸é—­åŒ…å¦‚æœéœ€è¦ä½¿ç”¨å¯¹è±¡çš„å˜é‡æˆ–å¸¸é‡çš„æ—¶å€™ï¼Œå¿…é¡»æ˜¾ç¤ºæŒ‡æ˜selfï¼Œå¦‚æœæ˜¯æ™®é€šçš„é—­åŒ…ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„å˜é‡æˆ–å¸¸é‡ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> completionHandlers: [() -&gt; <span class="type">Void</span>] = []</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">someFunctionWithEscapingClosure</span><span class="params">(completionHandler: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    completionHandlers.append(completionHandler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">someFunctionWithNonescapingClosure</span><span class="params">(closure: <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    closure()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">10</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">doSomething</span><span class="params">()</span></span> &#123;</span><br><span class="line">        someFunctionWithEscapingClosure &#123; <span class="keyword">self</span>.x = <span class="number">100</span> &#125;</span><br><span class="line">        someFunctionWithNonescapingClosure &#123; x = <span class="number">200</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance = <span class="type">SomeClass</span>()</span><br><span class="line">instance.doSomething()</span><br><span class="line"><span class="built_in">print</span>(instance.x)</span><br><span class="line"><span class="comment">// è¾“å‡º "200"</span></span><br><span class="line"></span><br><span class="line">completionHandlers.first?()</span><br><span class="line"><span class="built_in">print</span>(instance.x)</span><br><span class="line"><span class="comment">// è¾“å‡º "100"</span></span><br></pre></td></tr></table></figure>
<p>â€‹    åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬ä¸€ä¸ªprintè¾“å‡º200ï¼Œå› ä¸ºå½“è°ƒç”¨doSomethigçš„æ—¶å€™ï¼ŒsomeFunctionWithNonescapingClosureä¼šç›´æ¥è°ƒç”¨é—­åŒ…{x = 200},æ­¤æ—¶instance.xå˜æˆ200ï¼Œå½“completionHandlers.first?()ä¹‹åï¼ŒsomeFunctionWithEscapingClosureä¼ å…¥çš„é—­åŒ…æ‰ä¼šçœŸæ­£æ‰§è¡Œï¼Œæ­¤æ—¶instance.xå˜æˆ100.å¯ä»¥çœ‹åˆ°ï¼Œé€ƒé€¸é—­åŒ…å¿…é¡»æ˜¾ç¤ºæŒ‡æ˜selfï¼Œè€Œæ™®é€šçš„é—­åŒ…å¯ä»¥ç›´æ¥ä½¿ç”¨xã€‚</p>
<p><a href="http://1199game.com/2016/10/Swift-closure-3/" target="_blank" rel="external">http://1199game.com/2016/10/Swift-closure-3/</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/23/escaping/" class="archive-article-date">
  	<time datetime="2016-12-23T01:19:55.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-23</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Closure/">Closure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Escaping/">Escaping</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Swift/">Swift</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-æ–—é±¼" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/20/æ–—é±¼/">æ–—é±¼</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>é€†å‘å·¥ç¨‹ï¼Œé«˜ä»¿æ–—é±¼ç›´æ’­ï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p>
</blockquote>
<p><a href="https://github.com/zhangzhaopds/Douyu" target="_blank" rel="external">https://github.com/zhangzhaopds/Douyu</a></p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/douyu.PNG" alt=""></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/20/æ–—é±¼/" class="archive-article-date">
  	<time datetime="2016-12-20T06:56:10.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-20</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æ–—é±¼ç›´æ’­/">æ–—é±¼ç›´æ’­</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/é«˜ä»¿/">é«˜ä»¿</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Swift/">Swift</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-GPUImageå›¾åƒå¤„ç†" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/07/GPUImageå›¾åƒå¤„ç†/">GPUImageå›¾åƒå¤„ç†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>GPUImageæ˜¯Gitä¸Šä¸€ä¸ªéå¸¸å¼ºå¤§çš„å›¾åƒå¤„ç†æ¡†æ¶ï¼Œç°æœ‰çš„æ»¤é•œå°†è¿‘200ç§ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰æ–°çš„æ»¤é•œã€‚</p>
</blockquote>
<h4 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h4><p>GPUImage <a href="https://github.com/BradLarson/GPUImage" target="_blank" rel="external">https://github.com/BradLarson/GPUImage</a></p>
<p>ç®€å•Demo <a href="https://github.com/zhangzhaopds/GPUImage_Demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/GPUImage_Demo.git</a></p>
<h4 id="æ»¤é•œæ•ˆæœå›¾ï¼ˆéƒ¨åˆ†ï¼‰"><a href="#æ»¤é•œæ•ˆæœå›¾ï¼ˆéƒ¨åˆ†ï¼‰" class="headerlink" title="æ»¤é•œæ•ˆæœå›¾ï¼ˆéƒ¨åˆ†ï¼‰"></a>æ»¤é•œæ•ˆæœå›¾ï¼ˆéƒ¨åˆ†ï¼‰</h4><h5 id="GPUImageZoomBlurFilter"><a href="#GPUImageZoomBlurFilter" class="headerlink" title="GPUImageZoomBlurFilter"></a>GPUImageZoomBlurFilter</h5><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/GPUImageZoomBlurFilter.PNG" alt=""></p>
<h5 id="GPUImageNonMaximumSuppressionFilter"><a href="#GPUImageNonMaximumSuppressionFilter" class="headerlink" title="GPUImageNonMaximumSuppressionFilter"></a>GPUImageNonMaximumSuppressionFilter</h5><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/NonMaximumSuppressionFilter.PNG" alt=""></p>
<h5 id="GPUImageSketchFilter"><a href="#GPUImageSketchFilter" class="headerlink" title="GPUImageSketchFilter"></a>GPUImageSketchFilter</h5><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/GPUImageSketchFilter.JPG" alt=""></p>
<h5 id="GPUImageTransformFilter"><a href="#GPUImageTransformFilter" class="headerlink" title="GPUImageTransformFilter"></a>GPUImageTransformFilter</h5><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/GPUImageTransformFilter.PNG" alt=""></p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/IMG_0504.PNG" alt=""></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/07/GPUImageå›¾åƒå¤„ç†/" class="archive-article-date">
  	<time datetime="2016-12-07T08:31:34.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-07</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GPUImage/">GPUImage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æ»¤é•œ/">æ»¤é•œ</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ç›´æ’­å¼¹å¹•BarrageRenderer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/06/ç›´æ’­å¼¹å¹•BarrageRenderer/">ç›´æ’­å¼¹å¹•BarrageRenderer</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ä¸€ä¸ªå°è£…çš„ä¸é”™çš„å¼¹å¹•æ¡†æ¶ BarrageRendererã€‚</p>
</blockquote>
<p><a href="https://github.com/unash/BarrageRenderer" target="_blank" rel="external">https://github.com/unash/BarrageRenderer</a></p>
<p><a href="https://github.com/zhangzhaopds/BarrageRenderer_demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/BarrageRenderer_demo.git</a></p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/20150701210800504.jpg" alt=""></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/06/ç›´æ’­å¼¹å¹•BarrageRenderer/" class="archive-article-date">
  	<time datetime="2016-12-06T07:29:28.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-06</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BarrageRenderer/">BarrageRenderer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ç›´æ’­å¼¹å¹•/">ç›´æ’­å¼¹å¹•</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/05/IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶/">IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a href="https://github.com/Bilibili/ijkplayer" target="_blank" rel="external">IJKPlayer</a>æ˜¯Bç«™çš„ä¸€ä¸ªå¼€æºè§†é¢‘æ’­æ”¾æ¡†æ¶ï¼ŒåŸºäº<a href="https://zh.wikipedia.org/zh/FFmpeg" target="_blank" rel="external">FFMPEG</a>;</p>
<p>é›†æˆçš„è¿‡ç¨‹è¾ƒä¸ºç¹çï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<h4 id="é›†æˆ"><a href="#é›†æˆ" class="headerlink" title="é›†æˆ"></a>é›†æˆ</h4><p>æŒ‰ç…§å®˜æ–¹æ•™ç¨‹ä¸€æ­¥ä¸€æ­¥æ¥å°±è¡Œï¼Œå®˜ç½‘é“¾æ¥<a href="https://github.com/Bilibili/ijkplayer" target="_blank" rel="external">https://github.com/Bilibili/ijkplayer</a></p>
<p>è¿™ç¯‡åšå®¢å†™å¾—ä¹Ÿå¾ˆè¯¦ç»†ï¼Œ<a href="http://www.jianshu.com/p/4f21af680c19" target="_blank" rel="external">http://www.jianshu.com/p/4f21af680c19</a></p>
<p>è¿™ä¸ªæˆ‘æ‰“åŒ…å¥½çš„é™æ€åº“ï¼Œä¸‹è½½è§£å‹æ‹–åˆ°å·¥ç¨‹ã€æ·»åŠ ä¾èµ–åº“å°±èƒ½ç”¨ï¼š<a href="http://ohp8q40k9.bkt.clouddn.com/IJK.zip" target="_blank" rel="external">http://ohp8q40k9.bkt.clouddn.com/IJK.zip</a></p>
<h5 id="iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š"><a href="#iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š" class="headerlink" title="iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š"></a>iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š</h5><ol>
<li><p>åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨Terminalä¸­ï¼Œcdåˆ°æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ<code>git clone https://github.com/Bilibili/ijkplayer.git ijkplayer-ios</code>ï¼›</p>
</li>
<li><p>ç»§ç»­æ‰§è¡Œ<code>cd ijkplayer-ios</code>ï¼›</p>
</li>
<li><p>æ‰§è¡Œ<code>git checkout -B latest k0.7.5</code>ï¼Œå¼€è¾Ÿæ–°çš„åˆ†æ”¯<code>latest</code>ï¼›</p>
</li>
<li><p>æ‰§è¡Œ<code>./init-ios.sh</code>,è¿™ä¸ªè¿‡ç¨‹è¾ƒæ…¢ï¼Œå› ä¸ºè¦ä¸‹è½½180MBå·¦å³çš„æ–‡ä»¶ï¼›</p>
</li>
<li><p><code>cd ios</code>;</p>
</li>
<li><p><code>./compile-ffmpeg.sh clean</code>ï¼›</p>
</li>
<li><p><code>./compile-ffmpeg.sh all</code>,è¿™ä¸ªè¿‡ç¨‹ä¹Ÿè¾ƒæ…¢ï¼›æœ€ç»ˆæ•ˆæœï¼š</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk222.png" alt=""></p>
</li>
<li><p>æ‰“å¼€å·¥ç¨‹<code>IJKMediaDemo</code>, åœ¨plistä¸­æ·»åŠ  Camera å’Œ Photoçš„ç³»ç»Ÿåº”ç”¨æƒé™ï¼›ä¹‹åç¼–è¯‘å’Œè¿è¡Œåº”è¯¥éƒ½æ²¡é—®é¢˜ã€‚</p>
</li>
</ol>
<h4 id="é™æ€åº“çš„æ‰“åŒ…"><a href="#é™æ€åº“çš„æ‰“åŒ…" class="headerlink" title="é™æ€åº“çš„æ‰“åŒ…"></a>é™æ€åº“çš„æ‰“åŒ…</h4><p>åŸºäºä¸Šé¢å·²ç»èƒ½å¤ŸæˆåŠŸè¿è¡Œçš„å·¥ç¨‹ï¼Œå°†IJKPlayeræ‰“åŒ…æˆæ–¹ä¾¿ä½¿ç”¨çš„framework;</p>
<ol>
<li><p>é€‰æ‹© IJKMediaFramework â€” Edit Scheme â€” Run â€” Buid Configuration â€” Release;</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk02.png" alt=""></p>
</li>
<li><p>å°† IJKMediaFramework åˆ†åˆ«åœ¨æ¨¡æ‹Ÿå™¨å’ŒçœŸæœºä¸‹ç¼–è¯‘ command + B;</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk01.png" alt=""></p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk03.png" alt=""></p>
</li>
<li><p>æ‰“å¼€Productsä¸‹çš„ IJKMediaFramework.framework, å¯ä»¥çœ‹åˆ°Release-iphonesimulatorå’ŒRelease-iphoneosï¼›</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk04.png" alt=""></p>
</li>
<li><p>å°†æ¨¡æ‹Ÿå™¨å’ŒçœŸæœºçš„ä¸¤ä¸ªé™æ€åº“åˆå¹¶ï¼›åˆ°æ–‡ä»¶å¤¹/Build/Productsï¼Œä¾‹å¦‚ï¼š<code>cd /Users/zhangzhao/Library/Developer/Xcode/DerivedData/IJKMediaDemo-bwancsljxxihfseajvayxkzkonhi/Build/Products</code></p>
</li>
<li><p>åœ¨Productsä¸‹æ‰§è¡Œ <code>lipo -create Release-iphoneos/IJKMediaFramework.framework/IJKMediaFramework Release-iphonesimulator/IJKMediaFramework.framework/IJKMediaFramework -output IJKMediaFramework</code>åˆå¹¶ï¼›</p>
</li>
<li><p>ä¹‹åæ‰§è¡Œcopyæ“ä½œï¼Œ<code>cp IJKMediaFramework Release-iphoneos/IJKMediaFramework.framework/</code>;</p>
</li>
<li><p>é™æ€åº“<code>iphoneos/IJKMediaFramework.framework</code>å°±æ˜¯æœ€ç»ˆçš„ç»“æœã€‚</p>
</li>
</ol>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><ol>
<li><p>æ·»åŠ IJKMediaFramework.frameworkåˆ°æ–°å»ºçš„é¡¹ç›®ä¸­ï¼›</p>
</li>
<li><p>æ·»åŠ ä¾èµ–</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk5.png" alt=""></p>
<p>ç¼–è¯‘çš„æ—¶å€™å‡ºç°çš„ä»¥ä¸‹çš„æŠ¥é”™å°±æ˜¯ä¾èµ–åº“æ²¡æ·»åŠ å…¨</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijkkk.png" alt=""></p>
</li>
</ol>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/05/IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶/" class="archive-article-date">
  	<time datetime="2016-12-05T06:37:39.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-05</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IJKPlayer/">IJKPlayer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è§†é¢‘ç›´æ’­æ¡†æ¶/">è§†é¢‘ç›´æ’­æ¡†æ¶</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-OCR-åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/OCR-åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«/">OCR:åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ç”±äºé“¶è¡Œå¡çš„å¡é¢èƒŒæ™¯è‰²å½©åƒå·®ä¸‡åˆ«ï¼Œå¹¶ä¸”å¡å·çš„å°åˆ¶æ–¹å¼ï¼ˆå¹³å°ã€å‡¸å°ï¼‰ä¹Ÿä¸ç›¸åŒï¼Œæ‰€ä»¥è¿™ç§è¯†åˆ«æ–¹å¼çš„æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œå¯ä»¥è¯´å¾ˆå·®ï¼Œæš‚æ—¶å¯¹å¹³å°çš„å•ä¸€è‰²å½©çš„é“¶è¡Œå¡çš„è¯†åˆ«æ•ˆæœè¿˜è¡Œï¼›</p>
<p>è¿™ç§æ–¹å¼å¯ä»¥ç”¨æ¥åšèº«ä»½è¯çš„è¯†åˆ«ï¼Œæ•ˆæœå¾ˆå¥½ï¼Œå› ä¸ºèº«ä»½è¯èƒŒæ™¯é¢œè‰²æµ…ï¼Œè€Œä¸”æ ·å¼ä¸€è‡´ã€‚</p>
</blockquote>
<h4 id="æ•ˆæœå›¾ï¼š"><a href="#æ•ˆæœå›¾ï¼š" class="headerlink" title="æ•ˆæœå›¾ï¼š"></a>æ•ˆæœå›¾ï¼š</h4><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/detector.png" alt=""></p>
<h4 id="æœ¬æ–‡Demo"><a href="#æœ¬æ–‡Demo" class="headerlink" title="æœ¬æ–‡Demo"></a>æœ¬æ–‡Demo</h4><p><a href="https://github.com/zhangzhaopds/OCR_OpenCV_Tesseract_demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/OCR_OpenCV_Tesseract_demo.git</a></p>
<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>1ã€å¯¹é¢„è§ˆå›¾è¿›è¡Œåˆæ­¥çš„æ‰‹åŠ¨è£å‰ªï¼Œç¼©å°OpenCVçš„å¤„ç†èŒƒå›´ï¼›</p>
<p>2ã€åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡è¿›è¡Œåˆæ­¥çš„å¤„ç†ï¼ŒåŒ…æ‹¬ç°åº¦åŒ–å¤„ç†ã€äºŒé˜ˆå€¼å¤„ç†ã€è†¨èƒ€å¤„ç†ç­‰ï¼›</p>
<p>3ã€åˆ©ç”¨TesseractIOSOCRè¿›è¡Œå›¾ç‰‡çš„æ–‡å­—è¯†åˆ«ï¼›</p>
<h4 id="ä¸»è¦å®ç°"><a href="#ä¸»è¦å®ç°" class="headerlink" title="ä¸»è¦å®ç°"></a>ä¸»è¦å®ç°</h4><p>ä¾èµ–åº“ï¼š</p>
<p><code>pod &#39;OpenCV&#39;, &#39;~&gt; 3.0.0&#39;</code><br><code>pod &#39;TesseractOCRiOS&#39;, &#39;~&gt; 4.0.0&#39;</code></p>
<p>å®ç°ï¼ˆä»£ç ä¸­æœ‰è§£é‡Šï¼‰ï¼š</p>
<h4 id="å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†"><a href="#å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†" class="headerlink" title="å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†:"></a>å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†:</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†</span></span><br><span class="line">- (<span class="keyword">void</span>)detecteCardWithImage:(UIImage *)cardImage compleate:(CompleteBlock)complete &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     ç›¸å¯¹äºèº«ä»½è¯æ¥è¯´ï¼Œé“¶è¡Œå¡ç‰‡çš„èƒŒæ™¯ç¯å¢ƒåƒå·®ä¸‡åˆ«ï¼Œæœ‰çš„å¡ç‰‡æ— éœ€å¤„ç†è€Œæœ‰çš„åˆ™éœ€è¦ç°åº¦å€¼æˆ–äºŒé˜ˆå€¼é‡æ–°å¤„ç†ï¼Œç”¨ä¸€ç§æ–¹å¼å¤„ç†åƒç™¾ç§ç¯å¢ƒï¼Œç»“æœå¯æƒ³è€ŒçŸ¥ï¼›</span><br><span class="line">     è¿™é‡Œçš„è¯å°±ç®€å•çš„ï¼Œåœ¨å›¾ç‰‡çš„ä¸åŒå¤„ç†é˜¶æ®µè¿›è¡Œå¤šæ¬¡çš„æ–‡å­—è¯†åˆ«ï¼Œæœ€ååœ¨ç»Ÿä¸€å¤„ç†ï¼›</span><br><span class="line">     </span><br><span class="line">     ç¬¬ä¸€æ¬¡ï¼šå¡å·æ‰€åœ¨ä½ç½®çš„å›¾ç‰‡æˆªå–ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬äºŒæ¬¡ï¼šç°åº¦å€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬ä¸‰æ¬¡ï¼šäºŒé˜ˆå€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬å››æ¬¡ï¼šè…èš€åŒ–é‡æ–°æˆªå›¾å¹¶ç°åº¦å€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬äº”æ¬¡ï¼šè…èš€åŒ–é‡æ–°æˆªå›¾ã€ç°åº¦å€¼å¹¶äºŒé˜ˆå€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†å¡å·æ‰€åœ¨çš„å¤§è‡´ä½ç½®åœ¨å›¾ç‰‡ä¸Šæˆªå–å‡ºæ¥ï¼Œç¼©å°OpenCVè¦è¯†åˆ«çš„å›¾ç‰‡èŒƒå›´ï¼Œè®¤ä¸ºçš„æé«˜è¯†åˆ«æ•ˆç‡ã€‚</span></span><br><span class="line">    UIImage *corpImage = [self cropImageFromImage:cardImage];</span><br><span class="line">    <span class="keyword">if</span> (corpImage == nil) &#123;</span><br><span class="line">        complete(nil);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯†åˆ«ç»“æœçš„åˆæ­¥å¤„ç†</span></span><br><span class="line">    __<span class="function">weak <span class="title">typeof</span><span class="params">(self)</span> weakSelf </span>= self;</span><br><span class="line">    self.myBlock = ^(NSString *res) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¿¡ç”¨å¡16ä½ï¼Œå‚¨è“„å¡19ä½</span></span><br><span class="line">        <span class="keyword">if</span> (res.length &lt; <span class="number">16</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        NSString *result = [weakSelf findNumFromStr:res];</span><br><span class="line">        NSLog(@<span class="string">"ğŸ”¥%@"</span>, result);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (result.length &lt; <span class="number">16</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        complete(result);</span><br><span class="line">    &#125;;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// ç¬¬ä¸€æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: corpImage withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬ä¸€æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ©ç”¨OpenCVï¼Œå¯¹æˆªå–å‡ºæ¥çš„å›¾ç‰‡è¿›ä¸€æ­¥å¤„ç†,å¹¶è¿›è¡Œç±»å¤–å››æ¬¡çš„è¯†åˆ«</span></span><br><span class="line">    [self opencvScanCard:corpImage];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºè¯†åˆ«çš„æ¬¡æ•°å¢å¤šï¼Œæ‰€ä»¥ç»“æœçš„åé¦ˆè¾ƒæ…¢ï¼Œå¯ç›¸åº”å‡å°‘è¯†åˆ«æ¬¡æ•°ã€‚</p>
<h4 id="åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†"><a href="#åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†" class="headerlink" title="åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†"></a>åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)opencvScanCard:(UIImage *)image &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å›¾ç‰‡è½¬æ¢</span></span><br><span class="line">    cv::Mat resultImage;</span><br><span class="line">    UIImageToMat(image, resultImage);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç°åº¦å¤„ç†ï¼ˆå»é™¤å›¾ç‰‡çš„è‰²å½©å’Œå…‰äº®ï¼‰</span></span><br><span class="line">    cvtColor(resultImage, resultImage, cv::COLOR_BGR2GRAY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    __<span class="function">weak <span class="title">typeof</span><span class="params">(self)</span> weakSelf </span>= self;</span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬äºŒæ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// äºŒé˜ˆå€¼å¤„ç†</span></span><br><span class="line">    cv::threshold(resultImage, resultImage, <span class="number">100</span>, <span class="number">255</span>, CV_THRESH_BINARY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬ä¸‰æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬ä¸‰æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è…èš€ï¼šç™½è‰²èƒŒæ™¯ç¼©å°ï¼Œé»‘è‰²æ‰©å¤§</span></span><br><span class="line">    cv::Mat erodeElement = getStructuringElement(cv::MORPH_RECT, cv::Size(<span class="number">25</span>,<span class="number">25</span>)); <span class="comment">//3535</span></span><br><span class="line">    cv::erode(resultImage, resultImage, erodeElement);</span><br><span class="line">    </span><br><span class="line">    UIImage *ccc = MatToUIImage(resultImage);</span><br><span class="line">    UIImageWriteToSavedPhotosAlbum(ccc, nil, nil, nil);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è½®å»Šæ£€æµ‹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Point&gt;&gt; contours;</span><br><span class="line">    cv::findContours(resultImage, contours, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE, cvPoint(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å–å‡ºå¡å·åŒºåŸŸ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Rect&gt; rects;</span><br><span class="line">    cv::Rect numberRect = cv::Rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Point&gt;&gt;::const_iterator itContours = contours.begin();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ( ; itContours != contours.end(); ++itContours) &#123;</span><br><span class="line">        cv::Rect rect = cv::boundingRect(*itContours);</span><br><span class="line">        rects.push_back(rect);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (rect.width &gt; numberRect.width &amp;&amp; rect.width &gt; rect.height * <span class="number">5</span>) &#123;</span><br><span class="line">            numberRect = rect;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (numberRect.width == <span class="number">0</span> || numberRect.height == <span class="number">0</span>) &#123;</span><br><span class="line">        NSLog(@<span class="string">"å®šä½å¤±è´¥"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å®šä½æˆåŠŸï¼Œé‡æ–°æˆªå›¾</span></span><br><span class="line">    cv::Mat matImage;</span><br><span class="line">    UIImageToMat(image, matImage);</span><br><span class="line">    resultImage = matImage(numberRect);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡ç°åº¦å€¼å¤„ç†</span></span><br><span class="line">    cvtColor(resultImage, resultImage, cv::COLOR_BGR2GRAY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬å››æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬å››æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡äºŒé˜ˆå€¼å¤„ç†</span></span><br><span class="line">    cv::threshold(resultImage, resultImage, <span class="number">100</span>, <span class="number">255</span>, CV_THRESH_BINARY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äº”æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬äº”æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Tesseractè¯†åˆ«"><a href="#Tesseractè¯†åˆ«" class="headerlink" title="Tesseractè¯†åˆ«"></a>Tesseractè¯†åˆ«</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tesseractè¯†åˆ«</span></span><br><span class="line">- (<span class="keyword">void</span>)tesseractDetectorWithImage:(UIImage *)img withComplete:(CompleteBlock)complete &#123;</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, <span class="number">0</span>), ^&#123;</span><br><span class="line">        G8Tesseract *tesseract = [[G8Tesseract alloc] initWithLanguage:@<span class="string">"eng"</span>];</span><br><span class="line">        tesseract.image = [img g8_blackAndWhite];</span><br><span class="line">        tesseract.image = img;</span><br><span class="line">        [tesseract recognize];</span><br><span class="line">        complete(tesseract.recognizedText);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª"><a href="#é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª" class="headerlink" title="é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª"></a>é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è£å‰ªé“¶è¡Œå¡å·</span></span><br><span class="line">- (UIImage *)cropImageFromImage:(UIImage *)img &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> CGFloat cardWidth = <span class="number">400</span>;</span><br><span class="line">    <span class="keyword">static</span> CGFloat cardHeight = <span class="number">400</span>/<span class="number">1.59</span>;</span><br><span class="line">    </span><br><span class="line">    CGFloat h = img.size.height * <span class="number">500</span> / img.size.width;</span><br><span class="line">    UIGraphicsBeginImageContext(CGSizeMake(<span class="number">500</span>, h));</span><br><span class="line">    [img drawInRect:CGRectMake(<span class="number">0</span>, <span class="number">0</span>, <span class="number">500</span>, h)];</span><br><span class="line">    UIImage *scaleImg = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    </span><br><span class="line">    CGFloat y = (scaleImg.size.height - cardHeight) / <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    CGImageRef sourceImageRef = [scaleImg CGImage];</span><br><span class="line">    CGImageRef newImageRef = CGImageCreateWithImageInRect(sourceImageRef, CGRectMake(<span class="number">50</span>, y, cardWidth, cardHeight));</span><br><span class="line">    </span><br><span class="line">    CGImageRef resultImgRef = CGImageCreateWithImageInRect(newImageRef, CGRectMake(<span class="number">0</span>, <span class="number">130</span>, cardWidth, <span class="number">50</span>));</span><br><span class="line">    UIImage *mm = [UIImage imageWithCGImage:resultImgRef];</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        NSLog(@"%@", scaleImg);</span><br><span class="line">        NSLog(@"%@", [UIImage imageWithCGImage:newImageRef]);</span><br><span class="line">        NSLog(@"%@", mm);</span><br><span class="line">        UIImageWriteToSavedPhotosAlbum(scaleImg, nil, nil, nil);</span><br><span class="line">        UIImageWriteToSavedPhotosAlbum([UIImage imageWithCGImage:newImageRef], nil, nil, nil);</span><br><span class="line">        UIImageWriteToSavedPhotosAlbum(mm, nil, nil, nil);</span><br><span class="line">    &#125;)</span><br><span class="line">    */</span></span><br><span class="line">    <span class="keyword">return</span> mm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)clickedDetecteBtn:(UIButton *)sender &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ã€ç‚¹å‡»äº‹ä»¶ä¸­è°ƒç”¨å›¾ç‰‡è¯†åˆ«ï¼Œé˜²æ­¢CPUé£™å‡ã€‘</span></span><br><span class="line">    [[DetectorManager shareInstance] detecteCardWithImage:self.myImage compleate:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"è¯†åˆ«ç»“æœï¼š%@"</span>, result);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/tutorials.html" target="_blank" rel="external">OpenCVæ•™ç¨‹-http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/tutorials.html</a></p>
<p><a href="https://github.com/garnele007/SwiftOCR.git" target="_blank" rel="external">SwiftOCRæ•™ç¨‹-https://github.com/garnele007/SwiftOCR.git</a></p>
<p><a href="https://github.com/tesseract-ocr/tesseract.git" target="_blank" rel="external">Tesseractæ•™ç¨‹-https://github.com/tesseract-ocr/tesseract.git</a></p>
<p><a href="http://www.jianshu.com/p/7462275f93ac" target="_blank" rel="external">http://www.jianshu.com/p/7462275f93ac</a></p>
<p><a href="https://github.com/iosWellLin/OCR.git" target="_blank" rel="external">https://github.com/iosWellLin/OCR.git</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/01/OCR-åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«/" class="archive-article-date">
  	<time datetime="2016-12-01T08:50:30.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-01</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OCR/">OCR</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenCV/">OpenCV</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tesseract/">Tesseract</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/28/iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«/">iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>CIDetectoræ˜¯iOSä¸­è‡ªå¸¦çš„äººè„¸è¯†åˆ«æ¡†æ¶ï¼Œä½¿ç”¨èµ·æ¥ç›¸å¯¹æ–¹ä¾¿ã€‚</p>
</blockquote>
<h4 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h4><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/renlian.png" alt=""></p>
<h4 id="æœ¬æ–‡Demo"><a href="#æœ¬æ–‡Demo" class="headerlink" title="æœ¬æ–‡Demo"></a>æœ¬æ–‡Demo</h4><p><a href="https://github.com/zhangzhaopds/CIDetector_demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/CIDetector_demo.git</a></p>
<h4 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äººè„¸è¯†åˆ«</span></span><br><span class="line">- (void)detectorFace &#123;</span><br><span class="line">    <span class="comment">// ä¸Šä¸‹æ–‡</span></span><br><span class="line">    <span class="type">CIContext</span> *content = [<span class="type">CIContext</span> contextWithOptions:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     1ã€è¯†åˆ«ç²¾åº¦ Detector Accuracy</span><br><span class="line">     </span><br><span class="line">        key: CIDetectorAccuracy</span><br><span class="line">        value: CIDetectorAccuracyLow    ä½ç²¾åº¦è¯†åˆ«é€Ÿåº¦å¿«</span><br><span class="line">               CIDetectorAccuracyHigh   é«˜ç²¾åº¦è¯†åˆ«é€Ÿåº¦æ…¢</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     2ã€è¯†åˆ«ç±»å‹ Detector Types</span><br><span class="line">     </span><br><span class="line">        CIDetectorTypeFace      é¢éƒ¨è¯†åˆ«</span><br><span class="line">        CIDetectorTypeRectangle çŸ©å½¢è¯†åˆ«</span><br><span class="line">        CIDetectorTypeQRCode    æ¡ç è¯†åˆ«</span><br><span class="line">        CIDetectorTypeText      æ–‡æœ¬è¯†åˆ«</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     3ã€ å…·ä½“ç‰¹å¾ Feature Detection</span><br><span class="line">     </span><br><span class="line">        CIDetectorImageOrientation  å›¾ç‰‡æ–¹å‘</span><br><span class="line">        CIDetectorEyeBlink          è¯†åˆ«çœ¨çœ¼ï¼ˆclosed eyesï¼‰</span><br><span class="line">        CIDetectorSmile             ç¬‘è„¸</span><br><span class="line">        CIDetectorFocalLength       ç„¦è·</span><br><span class="line">        CIDetectorAspectRatio       çŸ©å½¢å®½é«˜æ¯”</span><br><span class="line">        CIDetectorReturnSubFeatures æ˜¯å¦æ£€æµ‹å­ç‰¹å¾</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é…ç½®è¯†åˆ«è´¨é‡</span></span><br><span class="line">    <span class="type">NSDictionary</span> *param = [<span class="type">NSDictionary</span> dictionaryWithObject:<span class="type">CIDetectorAccuracyHigh</span> forKey:<span class="type">CIDetectorAccuracy</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºäººè„¸è¯†åˆ«å™¨</span></span><br><span class="line">    <span class="type">CIDetector</span> *detector = [<span class="type">CIDetector</span> detectorOfType:<span class="type">CIDetectorTypeFace</span> context:content options:param];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯†åˆ«å›¾ç‰‡</span></span><br><span class="line">    <span class="type">CIImage</span> *ciImg = [<span class="type">CIImage</span> imageWithCGImage:_myImageView.image.<span class="type">CGImage</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯†åˆ«ç‰¹å¾: è¿™é‡Œæ·»åŠ äº†çœ¨çœ¼å’Œå¾®ç¬‘</span></span><br><span class="line">    <span class="comment">// CIDetectorSmile çœ¼éƒ¨çš„è¯†åˆ«æ•ˆæœå¾ˆå·®ï¼Œå¾ˆéš¾è¯†åˆ«å‡ºæ¥</span></span><br><span class="line">    <span class="type">NSDictionary</span> *featuresParam = @&#123;<span class="type">CIDetectorSmile</span>: [<span class="type">NSNumber</span> numberWithBool:<span class="literal">true</span>],</span><br><span class="line">                                    <span class="type">CIDetectorEyeBlink</span>: [<span class="type">NSNumber</span> numberWithBool:<span class="literal">true</span>]&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–è¯†åˆ«ç»“æœ</span></span><br><span class="line">    <span class="type">NSArray</span> *resultArr = [detector featuresInImage:ciImg options:featuresParam];</span><br><span class="line">    </span><br><span class="line">    <span class="type">UIView</span> *resultView = [[<span class="type">UIView</span> alloc] initWithFrame:_myImageView.frame];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:resultView];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">CIFaceFeature</span> *feature <span class="keyword">in</span> resultArr) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å¾®ç¬‘ï¼š%d"</span>, feature.hasSmile);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å³çœ¼ï¼š%d"</span>, feature.rightEyeClosed);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å·¦çœ¼ï¼š%d"</span>, feature.leftEyeClosed);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"è„¸æ¡†ï¼š%d"</span>, feature.hasFaceAngle);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å˜´ï¼š%d"</span>, feature.hasMouthPosition);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/** </span><br><span class="line">         å…³äºfeatureä¸­çš„positionéœ€è¦æ³¨æ„çš„æ˜¯:</span><br><span class="line">            positionæ˜¯ä»¥æ‰€è¦è¯†åˆ«å›¾åƒçš„åŸå§‹å°ºå¯¸ä¸ºæ ‡å‡†ï¼›</span><br><span class="line">            å› æ­¤ï¼Œ</span><br><span class="line">            å¦‚æœè£…è½½å›¾ç‰‡çš„UIImageViewçš„å°ºå¯¸ä¸å›¾ç‰‡åŸå§‹å°ºå¯¸ä¸ä¸€æ ·çš„è¯ï¼Œä¼šå‡ºç°è¯†åˆ«çš„ä½ç½®æœ‰åå·®ã€‚</span><br><span class="line">         */</span></span><br><span class="line">        <span class="type">UIView</span> *faceView = [[<span class="type">UIView</span> alloc] initWithFrame:feature.bounds];</span><br><span class="line">        faceView.layer.borderColor = [<span class="type">UIColor</span> redColor].<span class="type">CGColor</span>;</span><br><span class="line">        faceView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">        [resultView addSubview:faceView];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åæ ‡ç³»çš„è½¬æ¢</span></span><br><span class="line">        [resultView setTransform:<span class="type">CGAffineTransformMakeScale</span>(<span class="number">1</span>, -<span class="number">1</span>)];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å·¦çœ¼</span></span><br><span class="line">        <span class="keyword">if</span> (feature.hasLeftEyePosition) &#123;</span><br><span class="line">            <span class="type">UIView</span> * leftEyeView = [[<span class="type">UIView</span> alloc] initWithFrame:<span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="number">20</span>)];</span><br><span class="line">            [leftEyeView setCenter:feature.leftEyePosition];</span><br><span class="line">            leftEyeView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">            leftEyeView.layer.borderColor = [<span class="type">UIColor</span> greenColor].<span class="type">CGColor</span>;</span><br><span class="line">            [resultView addSubview:leftEyeView];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å³çœ¼</span></span><br><span class="line">        <span class="keyword">if</span> (feature.hasRightEyePosition) &#123;</span><br><span class="line">            <span class="type">UIView</span> * rightEyeView = [[<span class="type">UIView</span> alloc] initWithFrame:<span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>)];</span><br><span class="line">            [rightEyeView setCenter:feature.rightEyePosition];</span><br><span class="line">            rightEyeView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">            rightEyeView.layer.borderColor = [<span class="type">UIColor</span> redColor].<span class="type">CGColor</span>;</span><br><span class="line">            [resultView addSubview:rightEyeView];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å˜´éƒ¨</span></span><br><span class="line">        <span class="keyword">if</span> (feature.hasMouthPosition) &#123;</span><br><span class="line">            <span class="type">UIView</span> * mouthView = [[<span class="type">UIView</span> alloc] initWithFrame:<span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">30</span>)];</span><br><span class="line">            [mouthView setCenter:feature.mouthPosition];</span><br><span class="line">            mouthView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">            mouthView.layer.borderColor = [<span class="type">UIColor</span> redColor].<span class="type">CGColor</span>;</span><br><span class="line">            [resultView addSubview:mouthView];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/28/iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«/" class="archive-article-date">
  	<time datetime="2016-11-28T06:10:07.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CIDetector/">CIDetector</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/äººè„¸è¯†åˆ«/">äººè„¸è¯†åˆ«</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/28/iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«/">iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>OpenCV æ˜¯ä¸€ä¸ªå¼€æºçš„è®¡ç®—æœºè§†è§‰å’Œæœºå™¨å­¦ä¹ åº“ã€‚</p>
<p>ä¸iOSç³»ç»Ÿè‡ªå¸¦çš„è¯†åˆ«åº“ä¸€æ ·ï¼Œå¯¹äºä¾§è„¸çš„è¯†åˆ«å¾ˆæ— åŠ›ã€‚ç®€å•è®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="ç›¸å…³å‚è€ƒ"><a href="#ç›¸å…³å‚è€ƒ" class="headerlink" title="ç›¸å…³å‚è€ƒ"></a>ç›¸å…³å‚è€ƒ</h3><p><a href="https://objccn.io/issue-21-9/" target="_blank" rel="external">https://objccn.io/issue-21-9/</a></p>
<p><a href="http://www.jianshu.com/p/7a055b7eb14c" target="_blank" rel="external">http://www.jianshu.com/p/7a055b7eb14c</a></p>
<h4 id="æœ¬æ–‡demo"><a href="#æœ¬æ–‡demo" class="headerlink" title="æœ¬æ–‡demo"></a>æœ¬æ–‡demo</h4><p><a href="https://github.com/zhangzhaopds/OpenCV_Demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/OpenCV_Demo.git</a></p>
<h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h3><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/IMG_0324.PNG" alt=""></p>
<h3 id="éƒ¨ç½²ä¸ä½¿ç”¨"><a href="#éƒ¨ç½²ä¸ä½¿ç”¨" class="headerlink" title="éƒ¨ç½²ä¸ä½¿ç”¨"></a>éƒ¨ç½²ä¸ä½¿ç”¨</h3><p>CocoaPods</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#39;OpenCV&#39;, &#39;~&#62; 3.0.0&#39;</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">import</span> "OpenCVUtil.h"</span><br><span class="line"></span><br><span class="line">#<span class="keyword">import</span> &lt;opencv2/opencv.hpp&gt;</span><br><span class="line">#<span class="keyword">import</span> &lt;opencv2/imgproc/types_c.h&gt;</span><br><span class="line">#<span class="keyword">import</span> &lt;opencv2/imgcodecs/ios.h&gt;</span><br><span class="line"></span><br><span class="line">@implementation <span class="type">OpenCVUtil</span></span><br><span class="line"></span><br><span class="line">+ (<span class="type">UIImage</span> *)convertImage: (<span class="type">UIImage</span> *)image &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªå›¾ç‰‡çš„äºŒç»´çŸ©é˜µcvImage</span></span><br><span class="line">    cv::<span class="type">Mat</span> cvImage;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†å›¾ç‰‡UIImageå¯¹è±¡è½¬ä¸ºMatå¯¹è±¡</span></span><br><span class="line">    <span class="type">UIImageToMat</span>(image, cvImage);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!cvImage.empty()) &#123;</span><br><span class="line">        cv::<span class="type">Mat</span> gray;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿›ä¸€æ­¥å°†å›¾ç‰‡è½¬ä¸ºç°åº¦æ˜¾ç¤º</span></span><br><span class="line">        cv::cvtColor(cvImage, gray, <span class="type">CV_RGB2GRAY</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ©ç”¨ææ­»æ»¤é•œå»é™¤è¾¹ç¼˜</span></span><br><span class="line">        cv::<span class="type">GaussianBlur</span>(gray, gray, cv::<span class="type">Size</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="number">1.2</span>, <span class="number">1.2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®—ç”»å¸ƒ</span></span><br><span class="line">        cv::<span class="type">Mat</span> edges;</span><br><span class="line">        cv::<span class="type">Canny</span>(gray, edges, <span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨ç™½è‰²å¡«å……</span></span><br><span class="line">        cvImage.setTo(cv::<span class="type">Scalar</span>::all(<span class="number">225</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¿®æ”¹è¾¹ç¼˜é¢œè‰²</span></span><br><span class="line">        cvImage.setTo(cv::<span class="type">Scalar</span>(<span class="number">0</span>,<span class="number">128</span>,<span class="number">255</span>,<span class="number">255</span>),edges);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†Matè½¬æ¢ä¸ºUIImage</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">MatToUIImage</span>(cvImage);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">NSArray</span>*)facePointDetectForImage:(<span class="type">UIImage</span>*)image&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> cv::<span class="type">CascadeClassifier</span> faceDetector;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ xmlæ–‡ä»¶</span></span><br><span class="line">        <span class="type">NSString</span>* cascadePath = [[<span class="type">NSBundle</span> mainBundle]</span><br><span class="line">                                 pathForResource:@<span class="string">"haarcascade_frontalface_alt2"</span></span><br><span class="line">                                 ofType:@<span class="string">"xml"</span>];</span><br><span class="line">        faceDetector.load([cascadePath <span class="type">UTF8String</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    cv::<span class="type">Mat</span> faceImage;</span><br><span class="line">    <span class="type">UIImageToMat</span>(image, faceImage);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è½¬ä¸ºç°åº¦</span></span><br><span class="line">    cv::<span class="type">Mat</span> gray;</span><br><span class="line">    cvtColor(faceImage, gray, <span class="type">CV_BGR2GRAY</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æµ‹äººè„¸å¹¶å‚¨å­˜</span></span><br><span class="line">    std::vector&lt;cv::<span class="type">Rect</span>&gt;faces;</span><br><span class="line">    faceDetector.detectMultiScale(gray, faces,<span class="number">1.1</span>,<span class="number">2</span>,<span class="type">CV_HAAR_FIND_BIGGEST_OBJECT</span>,cv::<span class="type">Size</span>(<span class="number">30</span>,<span class="number">30</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="type">NSMutableArray</span> *array = [<span class="type">NSMutableArray</span> array];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(unsigned int i= <span class="number">0</span>;i &lt; faces.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        const cv::<span class="type">Rect</span>&amp; face = faces[i];</span><br><span class="line">        float height = (float)faceImage.rows;</span><br><span class="line">        float width = (float)faceImage.cols;</span><br><span class="line">        <span class="type">CGRect</span> rect = <span class="type">CGRectMake</span>(face.x/width, face.y/height, face.width/width, face.height/height);</span><br><span class="line">        [array addObject:[<span class="type">NSNumber</span> valueWithCGRect:rect]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [array copy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">UIImage</span>*)faceDetectForImage:(<span class="type">UIImage</span>*)image &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> cv::<span class="type">CascadeClassifier</span> faceDetector;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="type">NSString</span>* cascadePath = [[<span class="type">NSBundle</span> mainBundle]</span><br><span class="line">                        pathForResource:@<span class="string">"haarcascade_frontalface_alt"</span></span><br><span class="line">                                 ofType:@<span class="string">"xml"</span>];</span><br><span class="line">        faceDetector.load([cascadePath <span class="type">UTF8String</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    cv::<span class="type">Mat</span> faceImage;</span><br><span class="line">    <span class="type">UIImageToMat</span>(image, faceImage);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è½¬ä¸ºç°åº¦</span></span><br><span class="line">    cv::<span class="type">Mat</span> gray;</span><br><span class="line">    cvtColor(faceImage, gray, <span class="type">CV_BGR2GRAY</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æµ‹äººè„¸å¹¶å‚¨å­˜</span></span><br><span class="line">    std::vector&lt;cv::<span class="type">Rect</span>&gt;faces;</span><br><span class="line">    faceDetector.detectMultiScale(gray, faces,<span class="number">1.1</span>,<span class="number">2</span>,<span class="number">0</span>,cv::<span class="type">Size</span>(<span class="number">30</span>,<span class="number">30</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åœ¨æ¯ä¸ªäººè„¸ä¸Šç”»ä¸€ä¸ªçº¢è‰²å››æ–¹å½¢</span></span><br><span class="line">    <span class="keyword">for</span>(unsigned int i= <span class="number">0</span>;i &lt; faces.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        const cv::<span class="type">Rect</span>&amp; face = faces[i];</span><br><span class="line">        cv::<span class="type">Point</span> tl(face.x,face.y);</span><br><span class="line">        cv::<span class="type">Point</span> br = tl + cv::<span class="type">Point</span>(face.width,face.height);</span><br><span class="line">        <span class="comment">// å››æ–¹å½¢çš„ç”»æ³•</span></span><br><span class="line">        cv::<span class="type">Scalar</span> magenta = cv::<span class="type">Scalar</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line">        cv::rectangle(faceImage, tl, br, magenta, <span class="number">11</span>, <span class="number">8</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="type">MatToUIImage</span>(faceImage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">UIImage</span>*)circleDetectForImage:(<span class="type">UIImage</span>*)image&#123;</span><br><span class="line">    cv::<span class="type">Mat</span> circleImage,src_gray;</span><br><span class="line">    <span class="type">UIImageToMat</span>(image, circleImage);</span><br><span class="line">    <span class="comment">/// Convert it to gray</span></span><br><span class="line">    cvtColor( circleImage, src_gray, <span class="type">CV_BGR2GRAY</span> );</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Reduce the noise so we avoid false circle detection</span></span><br><span class="line">    <span class="type">GaussianBlur</span>( src_gray, src_gray, cv::<span class="type">Size</span>(<span class="number">9</span>, <span class="number">9</span>), <span class="number">2</span>, <span class="number">2</span> );</span><br><span class="line">    </span><br><span class="line">    std::vector&lt;cv::<span class="type">Vec3f</span>&gt; circles;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Apply the Hough Transform to find the circles</span></span><br><span class="line">    <span class="type">HoughCircles</span>( src_gray, circles, <span class="type">CV_HOUGH_GRADIENT</span>, <span class="number">1</span>, src_gray.rows/<span class="number">8</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Draw the circles detected</span></span><br><span class="line">    <span class="keyword">for</span>( size_t i = <span class="number">0</span>; i &lt; circles.size(); i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        cv::<span class="type">Point</span> center(cvRound(circles[i][<span class="number">0</span>]), cvRound(circles[i][<span class="number">1</span>]));</span><br><span class="line">        int radius = cvRound(circles[i][<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">// circle center</span></span><br><span class="line">        circle( circleImage, center, <span class="number">3</span>, cv::<span class="type">Scalar</span>(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>,<span class="number">255</span>), -<span class="number">1</span>, <span class="number">8</span>, <span class="number">0</span> );</span><br><span class="line">        <span class="comment">// circle outline</span></span><br><span class="line">        circle( circleImage, center, radius, cv::<span class="type">Scalar</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>), <span class="number">3</span>, <span class="number">8</span>, <span class="number">0</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Show your results</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">MatToUIImage</span>(circleImage);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h3 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">UIImage</span> *img = [<span class="type">UIImage</span> imageNamed:@<span class="string">"888.JPG"</span>];</span><br><span class="line">    _myImgView.image = img;</span><br><span class="line">    _detectImgView.image = [<span class="type">OpenCVUtil</span> faceDetectForImage:img];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/28/iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«/" class="archive-article-date">
  	<time datetime="2016-11-28T01:45:27.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenCV/">OpenCV</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/äººè„¸è¯†åˆ«/">äººè„¸è¯†åˆ«</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Jmsp
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: false
	}
</script>

<script src="/./main.js" type="text/javascript"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
    
    
    
  </ul>
  <div class="tools-wrap">
    

    

    

    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>