<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>Jmsp&#39;s Tips</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Jmsp's Tips">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Jmsp's Tips">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jmsp's Tips">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Jmsp&#39;s Tips" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/main.css" type="text/css">
  
<!-- baidu Analytics -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d400b2b9cf7d1a287b60931c6cbae186";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!-- End baidu Analytics -->


</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="http://7xoz39.com1.z0.glb.clouddn.com/BLOG_IMG_0412.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Jmsp</a></h1>
		</hgroup>

		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">ä¸»é¡µ</a></li>
	        
				<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
	        
				<li><a href="/categories/OC">OC</a></li>
	        
				<li><a href="/categories/Swift">Swift</a></li>
	        
				<li><a href="/categories/Android">Android</a></li>
	        
				<li><a href="/categories/ReactNative">ReactNative</a></li>
	        
				<li><a href="/categories/PHP">PHP</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
            
    			
            
    			
            
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/zhangzhaopds weibo: " title="github">github</a>
		        
					<a class="rss" target="_blank" href="/#" title="rss">rss</a>
		        
					<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Jmsp</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="http://7xoz39.com1.z0.glb.clouddn.com/BLOG_IMG_0412.png" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Jmsp</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
					<li><a href="/categories/OC">OC</a></li>
		        
					<li><a href="/categories/Swift">Swift</a></li>
		        
					<li><a href="/categories/Android">Android</a></li>
		        
					<li><a href="/categories/ReactNative">ReactNative</a></li>
		        
					<li><a href="/categories/PHP">PHP</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/zhangzhaopds weibo: " title="github">github</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-ç›´æ’­å¼¹å¹•BarrageRenderer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/06/ç›´æ’­å¼¹å¹•BarrageRenderer/">ç›´æ’­å¼¹å¹•BarrageRenderer</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ä¸€ä¸ªå°è£…çš„ä¸é”™çš„å¼¹å¹•æ¡†æ¶ BarrageRendererã€‚</p>
</blockquote>
<p><a href="https://github.com/unash/BarrageRenderer" target="_blank" rel="external">https://github.com/unash/BarrageRenderer</a></p>
<p><a href="https://github.com/zhangzhaopds/BarrageRenderer_demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/BarrageRenderer_demo.git</a></p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/20150701210800504.jpg" alt=""></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/06/ç›´æ’­å¼¹å¹•BarrageRenderer/" class="archive-article-date">
  	<time datetime="2016-12-06T07:29:28.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-06</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BarrageRenderer/">BarrageRenderer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ç›´æ’­å¼¹å¹•/">ç›´æ’­å¼¹å¹•</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/05/IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶/">IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a href="https://github.com/Bilibili/ijkplayer" target="_blank" rel="external">IJKPlayer</a>æ˜¯Bç«™çš„ä¸€ä¸ªå¼€æºè§†é¢‘æ’­æ”¾æ¡†æ¶ï¼ŒåŸºäº<a href="https://zh.wikipedia.org/zh/FFmpeg" target="_blank" rel="external">FFMPEG</a>;</p>
<p>é›†æˆçš„è¿‡ç¨‹è¾ƒä¸ºç¹çï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<h4 id="é›†æˆ"><a href="#é›†æˆ" class="headerlink" title="é›†æˆ"></a>é›†æˆ</h4><p>æŒ‰ç…§å®˜æ–¹æ•™ç¨‹ä¸€æ­¥ä¸€æ­¥æ¥å°±è¡Œï¼Œå®˜ç½‘é“¾æ¥<a href="https://github.com/Bilibili/ijkplayer" target="_blank" rel="external">https://github.com/Bilibili/ijkplayer</a></p>
<p>è¿™ç¯‡åšå®¢å†™å¾—ä¹Ÿå¾ˆè¯¦ç»†ï¼Œ<a href="http://www.jianshu.com/p/4f21af680c19" target="_blank" rel="external">http://www.jianshu.com/p/4f21af680c19</a></p>
<p>è¿™ä¸ªæˆ‘æ‰“åŒ…å¥½çš„é™æ€åº“ï¼Œä¸‹è½½è§£å‹æ‹–åˆ°å·¥ç¨‹ã€æ·»åŠ ä¾èµ–åº“å°±èƒ½ç”¨ï¼š<a href="http://ohp8q40k9.bkt.clouddn.com/IJK.zip" target="_blank" rel="external">http://ohp8q40k9.bkt.clouddn.com/IJK.zip</a></p>
<h5 id="iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š"><a href="#iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š" class="headerlink" title="iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š"></a>iOSçš„é›†æˆä¸»è¦æœ‰ä»¥ä¸‹å‡ æ­¥éª¤ï¼š</h5><ol>
<li><p>åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨Terminalä¸­ï¼Œcdåˆ°æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ<code>git clone https://github.com/Bilibili/ijkplayer.git ijkplayer-ios</code>ï¼›</p>
</li>
<li><p>ç»§ç»­æ‰§è¡Œ<code>cd ijkplayer-ios</code>ï¼›</p>
</li>
<li><p>æ‰§è¡Œ<code>git checkout -B latest k0.7.5</code>ï¼Œå¼€è¾Ÿæ–°çš„åˆ†æ”¯<code>latest</code>ï¼›</p>
</li>
<li><p>æ‰§è¡Œ<code>./init-ios.sh</code>,è¿™ä¸ªè¿‡ç¨‹è¾ƒæ…¢ï¼Œå› ä¸ºè¦ä¸‹è½½180MBå·¦å³çš„æ–‡ä»¶ï¼›</p>
</li>
<li><p><code>cd ios</code>;</p>
</li>
<li><p><code>./compile-ffmpeg.sh clean</code>ï¼›</p>
</li>
<li><p><code>./compile-ffmpeg.sh all</code>,è¿™ä¸ªè¿‡ç¨‹ä¹Ÿè¾ƒæ…¢ï¼›æœ€ç»ˆæ•ˆæœï¼š</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk222.png" alt=""></p>
</li>
<li><p>æ‰“å¼€å·¥ç¨‹<code>IJKMediaDemo</code>, åœ¨plistä¸­æ·»åŠ  Camera å’Œ Photoçš„ç³»ç»Ÿåº”ç”¨æƒé™ï¼›ä¹‹åç¼–è¯‘å’Œè¿è¡Œåº”è¯¥éƒ½æ²¡é—®é¢˜ã€‚</p>
</li>
</ol>
<h4 id="é™æ€åº“çš„æ‰“åŒ…"><a href="#é™æ€åº“çš„æ‰“åŒ…" class="headerlink" title="é™æ€åº“çš„æ‰“åŒ…"></a>é™æ€åº“çš„æ‰“åŒ…</h4><p>åŸºäºä¸Šé¢å·²ç»èƒ½å¤ŸæˆåŠŸè¿è¡Œçš„å·¥ç¨‹ï¼Œå°†IJKPlayeræ‰“åŒ…æˆæ–¹ä¾¿ä½¿ç”¨çš„framework;</p>
<ol>
<li><p>é€‰æ‹© IJKMediaFramework â€” Edit Scheme â€” Run â€” Buid Configuration â€” Release;</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk02.png" alt=""></p>
</li>
<li><p>å°† IJKMediaFramework åˆ†åˆ«åœ¨æ¨¡æ‹Ÿå™¨å’ŒçœŸæœºä¸‹ç¼–è¯‘ command + B;</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk01.png" alt=""></p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk03.png" alt=""></p>
</li>
<li><p>æ‰“å¼€Productsä¸‹çš„ IJKMediaFramework.framework, å¯ä»¥çœ‹åˆ°Release-iphonesimulatorå’ŒRelease-iphoneosï¼›</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk04.png" alt=""></p>
</li>
<li><p>å°†æ¨¡æ‹Ÿå™¨å’ŒçœŸæœºçš„ä¸¤ä¸ªé™æ€åº“åˆå¹¶ï¼›åˆ°æ–‡ä»¶å¤¹/Build/Productsï¼Œä¾‹å¦‚ï¼š<code>cd /Users/zhangzhao/Library/Developer/Xcode/DerivedData/IJKMediaDemo-bwancsljxxihfseajvayxkzkonhi/Build/Products</code></p>
</li>
<li><p>åœ¨Productsä¸‹æ‰§è¡Œ <code>lipo -create Release-iphoneos/IJKMediaFramework.framework/IJKMediaFramework Release-iphonesimulator/IJKMediaFramework.framework/IJKMediaFramework -output IJKMediaFramework</code>åˆå¹¶ï¼›</p>
</li>
<li><p>ä¹‹åæ‰§è¡Œcopyæ“ä½œï¼Œ<code>cp IJKMediaFramework Release-iphoneos/IJKMediaFramework.framework/</code>;</p>
</li>
<li><p>é™æ€åº“<code>iphoneos/IJKMediaFramework.framework</code>å°±æ˜¯æœ€ç»ˆçš„ç»“æœã€‚</p>
</li>
</ol>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><ol>
<li><p>æ·»åŠ IJKMediaFramework.frameworkåˆ°æ–°å»ºçš„é¡¹ç›®ä¸­ï¼›</p>
</li>
<li><p>æ·»åŠ ä¾èµ–</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijk5.png" alt=""></p>
<p>ç¼–è¯‘çš„æ—¶å€™å‡ºç°çš„ä»¥ä¸‹çš„æŠ¥é”™å°±æ˜¯ä¾èµ–åº“æ²¡æ·»åŠ å…¨</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/ijkkk.png" alt=""></p>
</li>
</ol>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/05/IJKPlayerè§†é¢‘ç›´æ’­æ¡†æ¶/" class="archive-article-date">
  	<time datetime="2016-12-05T06:37:39.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-05</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IJKPlayer/">IJKPlayer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è§†é¢‘ç›´æ’­æ¡†æ¶/">è§†é¢‘ç›´æ’­æ¡†æ¶</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-OCR-åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/OCR-åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«/">OCR:åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ç”±äºé“¶è¡Œå¡çš„å¡é¢èƒŒæ™¯è‰²å½©åƒå·®ä¸‡åˆ«ï¼Œå¹¶ä¸”å¡å·çš„å°åˆ¶æ–¹å¼ï¼ˆå¹³å°ã€å‡¸å°ï¼‰ä¹Ÿä¸ç›¸åŒï¼Œæ‰€ä»¥è¿™ç§è¯†åˆ«æ–¹å¼çš„æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œå¯ä»¥è¯´å¾ˆå·®ï¼Œæš‚æ—¶å¯¹å¹³å°çš„å•ä¸€è‰²å½©çš„é“¶è¡Œå¡çš„è¯†åˆ«æ•ˆæœè¿˜è¡Œï¼›</p>
<p>è¿™ç§æ–¹å¼å¯ä»¥ç”¨æ¥åšèº«ä»½è¯çš„è¯†åˆ«ï¼Œæ•ˆæœå¾ˆå¥½ï¼Œå› ä¸ºèº«ä»½è¯èƒŒæ™¯é¢œè‰²æµ…ï¼Œè€Œä¸”æ ·å¼ä¸€è‡´ã€‚</p>
</blockquote>
<h4 id="æ•ˆæœå›¾ï¼š"><a href="#æ•ˆæœå›¾ï¼š" class="headerlink" title="æ•ˆæœå›¾ï¼š"></a>æ•ˆæœå›¾ï¼š</h4><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/detector.png" alt=""></p>
<h4 id="æœ¬æ–‡Demo"><a href="#æœ¬æ–‡Demo" class="headerlink" title="æœ¬æ–‡Demo"></a>æœ¬æ–‡Demo</h4><p><a href="https://github.com/zhangzhaopds/OCR_OpenCV_Tesseract_demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/OCR_OpenCV_Tesseract_demo.git</a></p>
<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>1ã€å¯¹é¢„è§ˆå›¾è¿›è¡Œåˆæ­¥çš„æ‰‹åŠ¨è£å‰ªï¼Œç¼©å°OpenCVçš„å¤„ç†èŒƒå›´ï¼›</p>
<p>2ã€åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡è¿›è¡Œåˆæ­¥çš„å¤„ç†ï¼ŒåŒ…æ‹¬ç°åº¦åŒ–å¤„ç†ã€äºŒé˜ˆå€¼å¤„ç†ã€è†¨èƒ€å¤„ç†ç­‰ï¼›</p>
<p>3ã€åˆ©ç”¨TesseractIOSOCRè¿›è¡Œå›¾ç‰‡çš„æ–‡å­—è¯†åˆ«ï¼›</p>
<h4 id="ä¸»è¦å®ç°"><a href="#ä¸»è¦å®ç°" class="headerlink" title="ä¸»è¦å®ç°"></a>ä¸»è¦å®ç°</h4><p>ä¾èµ–åº“ï¼š</p>
<p><code>pod &#39;OpenCV&#39;, &#39;~&gt; 3.0.0&#39;</code><br><code>pod &#39;TesseractOCRiOS&#39;, &#39;~&gt; 4.0.0&#39;</code></p>
<p>å®ç°ï¼ˆä»£ç ä¸­æœ‰è§£é‡Šï¼‰ï¼š</p>
<h4 id="å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†"><a href="#å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†" class="headerlink" title="å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†:"></a>å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†:</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å›¾ç‰‡çš„å‰ªè£ã€è¯†åˆ«ä¸ç»“æœå¤„ç†</span></span><br><span class="line">- (<span class="keyword">void</span>)detecteCardWithImage:(UIImage *)cardImage compleate:(CompleteBlock)complete &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     ç›¸å¯¹äºèº«ä»½è¯æ¥è¯´ï¼Œé“¶è¡Œå¡ç‰‡çš„èƒŒæ™¯ç¯å¢ƒåƒå·®ä¸‡åˆ«ï¼Œæœ‰çš„å¡ç‰‡æ— éœ€å¤„ç†è€Œæœ‰çš„åˆ™éœ€è¦ç°åº¦å€¼æˆ–äºŒé˜ˆå€¼é‡æ–°å¤„ç†ï¼Œç”¨ä¸€ç§æ–¹å¼å¤„ç†åƒç™¾ç§ç¯å¢ƒï¼Œç»“æœå¯æƒ³è€ŒçŸ¥ï¼›</span><br><span class="line">     è¿™é‡Œçš„è¯å°±ç®€å•çš„ï¼Œåœ¨å›¾ç‰‡çš„ä¸åŒå¤„ç†é˜¶æ®µè¿›è¡Œå¤šæ¬¡çš„æ–‡å­—è¯†åˆ«ï¼Œæœ€ååœ¨ç»Ÿä¸€å¤„ç†ï¼›</span><br><span class="line">     </span><br><span class="line">     ç¬¬ä¸€æ¬¡ï¼šå¡å·æ‰€åœ¨ä½ç½®çš„å›¾ç‰‡æˆªå–ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬äºŒæ¬¡ï¼šç°åº¦å€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬ä¸‰æ¬¡ï¼šäºŒé˜ˆå€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬å››æ¬¡ï¼šè…èš€åŒ–é‡æ–°æˆªå›¾å¹¶ç°åº¦å€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     ç¬¬äº”æ¬¡ï¼šè…èš€åŒ–é‡æ–°æˆªå›¾ã€ç°åº¦å€¼å¹¶äºŒé˜ˆå€¼å¤„ç†ä¹‹åï¼Œè¿›è¡Œè¯†åˆ«ï¼›</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†å¡å·æ‰€åœ¨çš„å¤§è‡´ä½ç½®åœ¨å›¾ç‰‡ä¸Šæˆªå–å‡ºæ¥ï¼Œç¼©å°OpenCVè¦è¯†åˆ«çš„å›¾ç‰‡èŒƒå›´ï¼Œè®¤ä¸ºçš„æé«˜è¯†åˆ«æ•ˆç‡ã€‚</span></span><br><span class="line">    UIImage *corpImage = [self cropImageFromImage:cardImage];</span><br><span class="line">    <span class="keyword">if</span> (corpImage == nil) &#123;</span><br><span class="line">        complete(nil);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯†åˆ«ç»“æœçš„åˆæ­¥å¤„ç†</span></span><br><span class="line">    __<span class="function">weak <span class="title">typeof</span><span class="params">(self)</span> weakSelf </span>= self;</span><br><span class="line">    self.myBlock = ^(NSString *res) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¿¡ç”¨å¡16ä½ï¼Œå‚¨è“„å¡19ä½</span></span><br><span class="line">        <span class="keyword">if</span> (res.length &lt; <span class="number">16</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        NSString *result = [weakSelf findNumFromStr:res];</span><br><span class="line">        NSLog(@<span class="string">"ğŸ”¥%@"</span>, result);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (result.length &lt; <span class="number">16</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        complete(result);</span><br><span class="line">    &#125;;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// ç¬¬ä¸€æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: corpImage withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬ä¸€æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ©ç”¨OpenCVï¼Œå¯¹æˆªå–å‡ºæ¥çš„å›¾ç‰‡è¿›ä¸€æ­¥å¤„ç†,å¹¶è¿›è¡Œç±»å¤–å››æ¬¡çš„è¯†åˆ«</span></span><br><span class="line">    [self opencvScanCard:corpImage];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºè¯†åˆ«çš„æ¬¡æ•°å¢å¤šï¼Œæ‰€ä»¥ç»“æœçš„åé¦ˆè¾ƒæ…¢ï¼Œå¯ç›¸åº”å‡å°‘è¯†åˆ«æ¬¡æ•°ã€‚</p>
<h4 id="åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†"><a href="#åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†" class="headerlink" title="åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†"></a>åˆ©ç”¨OpenCVå¯¹å›¾ç‰‡çš„è¿›ä¸€æ­¥å¤„ç†</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)opencvScanCard:(UIImage *)image &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å›¾ç‰‡è½¬æ¢</span></span><br><span class="line">    cv::Mat resultImage;</span><br><span class="line">    UIImageToMat(image, resultImage);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç°åº¦å¤„ç†ï¼ˆå»é™¤å›¾ç‰‡çš„è‰²å½©å’Œå…‰äº®ï¼‰</span></span><br><span class="line">    cvtColor(resultImage, resultImage, cv::COLOR_BGR2GRAY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    __<span class="function">weak <span class="title">typeof</span><span class="params">(self)</span> weakSelf </span>= self;</span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬äºŒæ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// äºŒé˜ˆå€¼å¤„ç†</span></span><br><span class="line">    cv::threshold(resultImage, resultImage, <span class="number">100</span>, <span class="number">255</span>, CV_THRESH_BINARY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬ä¸‰æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬ä¸‰æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è…èš€ï¼šç™½è‰²èƒŒæ™¯ç¼©å°ï¼Œé»‘è‰²æ‰©å¤§</span></span><br><span class="line">    cv::Mat erodeElement = getStructuringElement(cv::MORPH_RECT, cv::Size(<span class="number">25</span>,<span class="number">25</span>)); <span class="comment">//3535</span></span><br><span class="line">    cv::erode(resultImage, resultImage, erodeElement);</span><br><span class="line">    </span><br><span class="line">    UIImage *ccc = MatToUIImage(resultImage);</span><br><span class="line">    UIImageWriteToSavedPhotosAlbum(ccc, nil, nil, nil);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è½®å»Šæ£€æµ‹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Point&gt;&gt; contours;</span><br><span class="line">    cv::findContours(resultImage, contours, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE, cvPoint(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å–å‡ºå¡å·åŒºåŸŸ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Rect&gt; rects;</span><br><span class="line">    cv::Rect numberRect = cv::Rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Point&gt;&gt;::const_iterator itContours = contours.begin();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ( ; itContours != contours.end(); ++itContours) &#123;</span><br><span class="line">        cv::Rect rect = cv::boundingRect(*itContours);</span><br><span class="line">        rects.push_back(rect);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (rect.width &gt; numberRect.width &amp;&amp; rect.width &gt; rect.height * <span class="number">5</span>) &#123;</span><br><span class="line">            numberRect = rect;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (numberRect.width == <span class="number">0</span> || numberRect.height == <span class="number">0</span>) &#123;</span><br><span class="line">        NSLog(@<span class="string">"å®šä½å¤±è´¥"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å®šä½æˆåŠŸï¼Œé‡æ–°æˆªå›¾</span></span><br><span class="line">    cv::Mat matImage;</span><br><span class="line">    UIImageToMat(image, matImage);</span><br><span class="line">    resultImage = matImage(numberRect);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡ç°åº¦å€¼å¤„ç†</span></span><br><span class="line">    cvtColor(resultImage, resultImage, cv::COLOR_BGR2GRAY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬å››æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬å››æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡äºŒé˜ˆå€¼å¤„ç†</span></span><br><span class="line">    cv::threshold(resultImage, resultImage, <span class="number">100</span>, <span class="number">255</span>, CV_THRESH_BINARY);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¬¬äº”æ¬¡è¯†åˆ«ï¼š</span></span><br><span class="line">    [self tesseractDetectorWithImage: MatToUIImage(resultImage) withComplete:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"ç¬¬äº”æ¬¡è¯†åˆ«ï¼š%@"</span>, result);</span><br><span class="line">        weakSelf.myBlock(result);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Tesseractè¯†åˆ«"><a href="#Tesseractè¯†åˆ«" class="headerlink" title="Tesseractè¯†åˆ«"></a>Tesseractè¯†åˆ«</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tesseractè¯†åˆ«</span></span><br><span class="line">- (<span class="keyword">void</span>)tesseractDetectorWithImage:(UIImage *)img withComplete:(CompleteBlock)complete &#123;</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, <span class="number">0</span>), ^&#123;</span><br><span class="line">        G8Tesseract *tesseract = [[G8Tesseract alloc] initWithLanguage:@<span class="string">"eng"</span>];</span><br><span class="line">        tesseract.image = [img g8_blackAndWhite];</span><br><span class="line">        tesseract.image = img;</span><br><span class="line">        [tesseract recognize];</span><br><span class="line">        complete(tesseract.recognizedText);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª"><a href="#é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª" class="headerlink" title="é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª"></a>é“¶è¡Œå¡ç‰‡çš„åˆæ¬¡è£å‰ª</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è£å‰ªé“¶è¡Œå¡å·</span></span><br><span class="line">- (UIImage *)cropImageFromImage:(UIImage *)img &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> CGFloat cardWidth = <span class="number">400</span>;</span><br><span class="line">    <span class="keyword">static</span> CGFloat cardHeight = <span class="number">400</span>/<span class="number">1.59</span>;</span><br><span class="line">    </span><br><span class="line">    CGFloat h = img.size.height * <span class="number">500</span> / img.size.width;</span><br><span class="line">    UIGraphicsBeginImageContext(CGSizeMake(<span class="number">500</span>, h));</span><br><span class="line">    [img drawInRect:CGRectMake(<span class="number">0</span>, <span class="number">0</span>, <span class="number">500</span>, h)];</span><br><span class="line">    UIImage *scaleImg = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    </span><br><span class="line">    CGFloat y = (scaleImg.size.height - cardHeight) / <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    CGImageRef sourceImageRef = [scaleImg CGImage];</span><br><span class="line">    CGImageRef newImageRef = CGImageCreateWithImageInRect(sourceImageRef, CGRectMake(<span class="number">50</span>, y, cardWidth, cardHeight));</span><br><span class="line">    </span><br><span class="line">    CGImageRef resultImgRef = CGImageCreateWithImageInRect(newImageRef, CGRectMake(<span class="number">0</span>, <span class="number">130</span>, cardWidth, <span class="number">50</span>));</span><br><span class="line">    UIImage *mm = [UIImage imageWithCGImage:resultImgRef];</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        NSLog(@"%@", scaleImg);</span><br><span class="line">        NSLog(@"%@", [UIImage imageWithCGImage:newImageRef]);</span><br><span class="line">        NSLog(@"%@", mm);</span><br><span class="line">        UIImageWriteToSavedPhotosAlbum(scaleImg, nil, nil, nil);</span><br><span class="line">        UIImageWriteToSavedPhotosAlbum([UIImage imageWithCGImage:newImageRef], nil, nil, nil);</span><br><span class="line">        UIImageWriteToSavedPhotosAlbum(mm, nil, nil, nil);</span><br><span class="line">    &#125;)</span><br><span class="line">    */</span></span><br><span class="line">    <span class="keyword">return</span> mm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)clickedDetecteBtn:(UIButton *)sender &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ã€ç‚¹å‡»äº‹ä»¶ä¸­è°ƒç”¨å›¾ç‰‡è¯†åˆ«ï¼Œé˜²æ­¢CPUé£™å‡ã€‘</span></span><br><span class="line">    [[DetectorManager shareInstance] detecteCardWithImage:self.myImage compleate:^(NSString *result) &#123;</span><br><span class="line">        NSLog(@<span class="string">"è¯†åˆ«ç»“æœï¼š%@"</span>, result);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/tutorials.html" target="_blank" rel="external">OpenCVæ•™ç¨‹-http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/tutorials.html</a></p>
<p><a href="https://github.com/garnele007/SwiftOCR.git" target="_blank" rel="external">SwiftOCRæ•™ç¨‹-https://github.com/garnele007/SwiftOCR.git</a></p>
<p><a href="https://github.com/tesseract-ocr/tesseract.git" target="_blank" rel="external">Tesseractæ•™ç¨‹-https://github.com/tesseract-ocr/tesseract.git</a></p>
<p><a href="http://www.jianshu.com/p/7462275f93ac" target="_blank" rel="external">http://www.jianshu.com/p/7462275f93ac</a></p>
<p><a href="https://github.com/iosWellLin/OCR.git" target="_blank" rel="external">https://github.com/iosWellLin/OCR.git</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/12/01/OCR-åŸºäºOpenCVã€Tesseractçš„é“¶è¡Œå¡å·è¯†åˆ«/" class="archive-article-date">
  	<time datetime="2016-12-01T08:50:30.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-01</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OCR/">OCR</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenCV/">OpenCV</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tesseract/">Tesseract</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/28/iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«/">iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>CIDetectoræ˜¯iOSä¸­è‡ªå¸¦çš„äººè„¸è¯†åˆ«æ¡†æ¶ï¼Œä½¿ç”¨èµ·æ¥ç›¸å¯¹æ–¹ä¾¿ã€‚</p>
</blockquote>
<h4 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h4><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/renlian.png" alt=""></p>
<h4 id="æœ¬æ–‡Demo"><a href="#æœ¬æ–‡Demo" class="headerlink" title="æœ¬æ–‡Demo"></a>æœ¬æ–‡Demo</h4><p><a href="https://github.com/zhangzhaopds/CIDetector_demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/CIDetector_demo.git</a></p>
<h4 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äººè„¸è¯†åˆ«</span></span><br><span class="line">- (void)detectorFace &#123;</span><br><span class="line">    <span class="comment">// ä¸Šä¸‹æ–‡</span></span><br><span class="line">    <span class="type">CIContext</span> *content = [<span class="type">CIContext</span> contextWithOptions:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     1ã€è¯†åˆ«ç²¾åº¦ Detector Accuracy</span><br><span class="line">     </span><br><span class="line">        key: CIDetectorAccuracy</span><br><span class="line">        value: CIDetectorAccuracyLow    ä½ç²¾åº¦è¯†åˆ«é€Ÿåº¦å¿«</span><br><span class="line">               CIDetectorAccuracyHigh   é«˜ç²¾åº¦è¯†åˆ«é€Ÿåº¦æ…¢</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     2ã€è¯†åˆ«ç±»å‹ Detector Types</span><br><span class="line">     </span><br><span class="line">        CIDetectorTypeFace      é¢éƒ¨è¯†åˆ«</span><br><span class="line">        CIDetectorTypeRectangle çŸ©å½¢è¯†åˆ«</span><br><span class="line">        CIDetectorTypeQRCode    æ¡ç è¯†åˆ«</span><br><span class="line">        CIDetectorTypeText      æ–‡æœ¬è¯†åˆ«</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     3ã€ å…·ä½“ç‰¹å¾ Feature Detection</span><br><span class="line">     </span><br><span class="line">        CIDetectorImageOrientation  å›¾ç‰‡æ–¹å‘</span><br><span class="line">        CIDetectorEyeBlink          è¯†åˆ«çœ¨çœ¼ï¼ˆclosed eyesï¼‰</span><br><span class="line">        CIDetectorSmile             ç¬‘è„¸</span><br><span class="line">        CIDetectorFocalLength       ç„¦è·</span><br><span class="line">        CIDetectorAspectRatio       çŸ©å½¢å®½é«˜æ¯”</span><br><span class="line">        CIDetectorReturnSubFeatures æ˜¯å¦æ£€æµ‹å­ç‰¹å¾</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é…ç½®è¯†åˆ«è´¨é‡</span></span><br><span class="line">    <span class="type">NSDictionary</span> *param = [<span class="type">NSDictionary</span> dictionaryWithObject:<span class="type">CIDetectorAccuracyHigh</span> forKey:<span class="type">CIDetectorAccuracy</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºäººè„¸è¯†åˆ«å™¨</span></span><br><span class="line">    <span class="type">CIDetector</span> *detector = [<span class="type">CIDetector</span> detectorOfType:<span class="type">CIDetectorTypeFace</span> context:content options:param];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯†åˆ«å›¾ç‰‡</span></span><br><span class="line">    <span class="type">CIImage</span> *ciImg = [<span class="type">CIImage</span> imageWithCGImage:_myImageView.image.<span class="type">CGImage</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯†åˆ«ç‰¹å¾: è¿™é‡Œæ·»åŠ äº†çœ¨çœ¼å’Œå¾®ç¬‘</span></span><br><span class="line">    <span class="comment">// CIDetectorSmile çœ¼éƒ¨çš„è¯†åˆ«æ•ˆæœå¾ˆå·®ï¼Œå¾ˆéš¾è¯†åˆ«å‡ºæ¥</span></span><br><span class="line">    <span class="type">NSDictionary</span> *featuresParam = @&#123;<span class="type">CIDetectorSmile</span>: [<span class="type">NSNumber</span> numberWithBool:<span class="literal">true</span>],</span><br><span class="line">                                    <span class="type">CIDetectorEyeBlink</span>: [<span class="type">NSNumber</span> numberWithBool:<span class="literal">true</span>]&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–è¯†åˆ«ç»“æœ</span></span><br><span class="line">    <span class="type">NSArray</span> *resultArr = [detector featuresInImage:ciImg options:featuresParam];</span><br><span class="line">    </span><br><span class="line">    <span class="type">UIView</span> *resultView = [[<span class="type">UIView</span> alloc] initWithFrame:_myImageView.frame];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:resultView];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">CIFaceFeature</span> *feature <span class="keyword">in</span> resultArr) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å¾®ç¬‘ï¼š%d"</span>, feature.hasSmile);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å³çœ¼ï¼š%d"</span>, feature.rightEyeClosed);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å·¦çœ¼ï¼š%d"</span>, feature.leftEyeClosed);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"è„¸æ¡†ï¼š%d"</span>, feature.hasFaceAngle);</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"å˜´ï¼š%d"</span>, feature.hasMouthPosition);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/** </span><br><span class="line">         å…³äºfeatureä¸­çš„positionéœ€è¦æ³¨æ„çš„æ˜¯:</span><br><span class="line">            positionæ˜¯ä»¥æ‰€è¦è¯†åˆ«å›¾åƒçš„åŸå§‹å°ºå¯¸ä¸ºæ ‡å‡†ï¼›</span><br><span class="line">            å› æ­¤ï¼Œ</span><br><span class="line">            å¦‚æœè£…è½½å›¾ç‰‡çš„UIImageViewçš„å°ºå¯¸ä¸å›¾ç‰‡åŸå§‹å°ºå¯¸ä¸ä¸€æ ·çš„è¯ï¼Œä¼šå‡ºç°è¯†åˆ«çš„ä½ç½®æœ‰åå·®ã€‚</span><br><span class="line">         */</span></span><br><span class="line">        <span class="type">UIView</span> *faceView = [[<span class="type">UIView</span> alloc] initWithFrame:feature.bounds];</span><br><span class="line">        faceView.layer.borderColor = [<span class="type">UIColor</span> redColor].<span class="type">CGColor</span>;</span><br><span class="line">        faceView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">        [resultView addSubview:faceView];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åæ ‡ç³»çš„è½¬æ¢</span></span><br><span class="line">        [resultView setTransform:<span class="type">CGAffineTransformMakeScale</span>(<span class="number">1</span>, -<span class="number">1</span>)];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å·¦çœ¼</span></span><br><span class="line">        <span class="keyword">if</span> (feature.hasLeftEyePosition) &#123;</span><br><span class="line">            <span class="type">UIView</span> * leftEyeView = [[<span class="type">UIView</span> alloc] initWithFrame:<span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="number">20</span>)];</span><br><span class="line">            [leftEyeView setCenter:feature.leftEyePosition];</span><br><span class="line">            leftEyeView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">            leftEyeView.layer.borderColor = [<span class="type">UIColor</span> greenColor].<span class="type">CGColor</span>;</span><br><span class="line">            [resultView addSubview:leftEyeView];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å³çœ¼</span></span><br><span class="line">        <span class="keyword">if</span> (feature.hasRightEyePosition) &#123;</span><br><span class="line">            <span class="type">UIView</span> * rightEyeView = [[<span class="type">UIView</span> alloc] initWithFrame:<span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>)];</span><br><span class="line">            [rightEyeView setCenter:feature.rightEyePosition];</span><br><span class="line">            rightEyeView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">            rightEyeView.layer.borderColor = [<span class="type">UIColor</span> redColor].<span class="type">CGColor</span>;</span><br><span class="line">            [resultView addSubview:rightEyeView];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å˜´éƒ¨</span></span><br><span class="line">        <span class="keyword">if</span> (feature.hasMouthPosition) &#123;</span><br><span class="line">            <span class="type">UIView</span> * mouthView = [[<span class="type">UIView</span> alloc] initWithFrame:<span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">30</span>)];</span><br><span class="line">            [mouthView setCenter:feature.mouthPosition];</span><br><span class="line">            mouthView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">            mouthView.layer.borderColor = [<span class="type">UIColor</span> redColor].<span class="type">CGColor</span>;</span><br><span class="line">            [resultView addSubview:mouthView];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/28/iOSä¸­åŸºäºCIDetectorçš„äººè„¸è¯†åˆ«/" class="archive-article-date">
  	<time datetime="2016-11-28T06:10:07.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CIDetector/">CIDetector</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/äººè„¸è¯†åˆ«/">äººè„¸è¯†åˆ«</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/28/iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«/">iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>OpenCV æ˜¯ä¸€ä¸ªå¼€æºçš„è®¡ç®—æœºè§†è§‰å’Œæœºå™¨å­¦ä¹ åº“ã€‚</p>
<p>ä¸iOSç³»ç»Ÿè‡ªå¸¦çš„è¯†åˆ«åº“ä¸€æ ·ï¼Œå¯¹äºä¾§è„¸çš„è¯†åˆ«å¾ˆæ— åŠ›ã€‚ç®€å•è®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="ç›¸å…³å‚è€ƒ"><a href="#ç›¸å…³å‚è€ƒ" class="headerlink" title="ç›¸å…³å‚è€ƒ"></a>ç›¸å…³å‚è€ƒ</h3><p><a href="https://objccn.io/issue-21-9/" target="_blank" rel="external">https://objccn.io/issue-21-9/</a></p>
<p><a href="http://www.jianshu.com/p/7a055b7eb14c" target="_blank" rel="external">http://www.jianshu.com/p/7a055b7eb14c</a></p>
<h4 id="æœ¬æ–‡demo"><a href="#æœ¬æ–‡demo" class="headerlink" title="æœ¬æ–‡demo"></a>æœ¬æ–‡demo</h4><p><a href="https://github.com/zhangzhaopds/OpenCV_Demo.git" target="_blank" rel="external">https://github.com/zhangzhaopds/OpenCV_Demo.git</a></p>
<h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h3><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/IMG_0324.PNG" alt=""></p>
<h3 id="éƒ¨ç½²ä¸ä½¿ç”¨"><a href="#éƒ¨ç½²ä¸ä½¿ç”¨" class="headerlink" title="éƒ¨ç½²ä¸ä½¿ç”¨"></a>éƒ¨ç½²ä¸ä½¿ç”¨</h3><p>CocoaPods</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#39;OpenCV&#39;, &#39;~&#62; 3.0.0&#39;</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">import</span> "OpenCVUtil.h"</span><br><span class="line"></span><br><span class="line">#<span class="keyword">import</span> &lt;opencv2/opencv.hpp&gt;</span><br><span class="line">#<span class="keyword">import</span> &lt;opencv2/imgproc/types_c.h&gt;</span><br><span class="line">#<span class="keyword">import</span> &lt;opencv2/imgcodecs/ios.h&gt;</span><br><span class="line"></span><br><span class="line">@implementation <span class="type">OpenCVUtil</span></span><br><span class="line"></span><br><span class="line">+ (<span class="type">UIImage</span> *)convertImage: (<span class="type">UIImage</span> *)image &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªå›¾ç‰‡çš„äºŒç»´çŸ©é˜µcvImage</span></span><br><span class="line">    cv::<span class="type">Mat</span> cvImage;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†å›¾ç‰‡UIImageå¯¹è±¡è½¬ä¸ºMatå¯¹è±¡</span></span><br><span class="line">    <span class="type">UIImageToMat</span>(image, cvImage);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!cvImage.empty()) &#123;</span><br><span class="line">        cv::<span class="type">Mat</span> gray;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿›ä¸€æ­¥å°†å›¾ç‰‡è½¬ä¸ºç°åº¦æ˜¾ç¤º</span></span><br><span class="line">        cv::cvtColor(cvImage, gray, <span class="type">CV_RGB2GRAY</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ©ç”¨ææ­»æ»¤é•œå»é™¤è¾¹ç¼˜</span></span><br><span class="line">        cv::<span class="type">GaussianBlur</span>(gray, gray, cv::<span class="type">Size</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="number">1.2</span>, <span class="number">1.2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®—ç”»å¸ƒ</span></span><br><span class="line">        cv::<span class="type">Mat</span> edges;</span><br><span class="line">        cv::<span class="type">Canny</span>(gray, edges, <span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨ç™½è‰²å¡«å……</span></span><br><span class="line">        cvImage.setTo(cv::<span class="type">Scalar</span>::all(<span class="number">225</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¿®æ”¹è¾¹ç¼˜é¢œè‰²</span></span><br><span class="line">        cvImage.setTo(cv::<span class="type">Scalar</span>(<span class="number">0</span>,<span class="number">128</span>,<span class="number">255</span>,<span class="number">255</span>),edges);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†Matè½¬æ¢ä¸ºUIImage</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">MatToUIImage</span>(cvImage);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">NSArray</span>*)facePointDetectForImage:(<span class="type">UIImage</span>*)image&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> cv::<span class="type">CascadeClassifier</span> faceDetector;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ xmlæ–‡ä»¶</span></span><br><span class="line">        <span class="type">NSString</span>* cascadePath = [[<span class="type">NSBundle</span> mainBundle]</span><br><span class="line">                                 pathForResource:@<span class="string">"haarcascade_frontalface_alt2"</span></span><br><span class="line">                                 ofType:@<span class="string">"xml"</span>];</span><br><span class="line">        faceDetector.load([cascadePath <span class="type">UTF8String</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    cv::<span class="type">Mat</span> faceImage;</span><br><span class="line">    <span class="type">UIImageToMat</span>(image, faceImage);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è½¬ä¸ºç°åº¦</span></span><br><span class="line">    cv::<span class="type">Mat</span> gray;</span><br><span class="line">    cvtColor(faceImage, gray, <span class="type">CV_BGR2GRAY</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æµ‹äººè„¸å¹¶å‚¨å­˜</span></span><br><span class="line">    std::vector&lt;cv::<span class="type">Rect</span>&gt;faces;</span><br><span class="line">    faceDetector.detectMultiScale(gray, faces,<span class="number">1.1</span>,<span class="number">2</span>,<span class="type">CV_HAAR_FIND_BIGGEST_OBJECT</span>,cv::<span class="type">Size</span>(<span class="number">30</span>,<span class="number">30</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="type">NSMutableArray</span> *array = [<span class="type">NSMutableArray</span> array];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(unsigned int i= <span class="number">0</span>;i &lt; faces.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        const cv::<span class="type">Rect</span>&amp; face = faces[i];</span><br><span class="line">        float height = (float)faceImage.rows;</span><br><span class="line">        float width = (float)faceImage.cols;</span><br><span class="line">        <span class="type">CGRect</span> rect = <span class="type">CGRectMake</span>(face.x/width, face.y/height, face.width/width, face.height/height);</span><br><span class="line">        [array addObject:[<span class="type">NSNumber</span> valueWithCGRect:rect]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [array copy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">UIImage</span>*)faceDetectForImage:(<span class="type">UIImage</span>*)image &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> cv::<span class="type">CascadeClassifier</span> faceDetector;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="type">NSString</span>* cascadePath = [[<span class="type">NSBundle</span> mainBundle]</span><br><span class="line">                        pathForResource:@<span class="string">"haarcascade_frontalface_alt"</span></span><br><span class="line">                                 ofType:@<span class="string">"xml"</span>];</span><br><span class="line">        faceDetector.load([cascadePath <span class="type">UTF8String</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    cv::<span class="type">Mat</span> faceImage;</span><br><span class="line">    <span class="type">UIImageToMat</span>(image, faceImage);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è½¬ä¸ºç°åº¦</span></span><br><span class="line">    cv::<span class="type">Mat</span> gray;</span><br><span class="line">    cvtColor(faceImage, gray, <span class="type">CV_BGR2GRAY</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æµ‹äººè„¸å¹¶å‚¨å­˜</span></span><br><span class="line">    std::vector&lt;cv::<span class="type">Rect</span>&gt;faces;</span><br><span class="line">    faceDetector.detectMultiScale(gray, faces,<span class="number">1.1</span>,<span class="number">2</span>,<span class="number">0</span>,cv::<span class="type">Size</span>(<span class="number">30</span>,<span class="number">30</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åœ¨æ¯ä¸ªäººè„¸ä¸Šç”»ä¸€ä¸ªçº¢è‰²å››æ–¹å½¢</span></span><br><span class="line">    <span class="keyword">for</span>(unsigned int i= <span class="number">0</span>;i &lt; faces.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        const cv::<span class="type">Rect</span>&amp; face = faces[i];</span><br><span class="line">        cv::<span class="type">Point</span> tl(face.x,face.y);</span><br><span class="line">        cv::<span class="type">Point</span> br = tl + cv::<span class="type">Point</span>(face.width,face.height);</span><br><span class="line">        <span class="comment">// å››æ–¹å½¢çš„ç”»æ³•</span></span><br><span class="line">        cv::<span class="type">Scalar</span> magenta = cv::<span class="type">Scalar</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line">        cv::rectangle(faceImage, tl, br, magenta, <span class="number">11</span>, <span class="number">8</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="type">MatToUIImage</span>(faceImage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">UIImage</span>*)circleDetectForImage:(<span class="type">UIImage</span>*)image&#123;</span><br><span class="line">    cv::<span class="type">Mat</span> circleImage,src_gray;</span><br><span class="line">    <span class="type">UIImageToMat</span>(image, circleImage);</span><br><span class="line">    <span class="comment">/// Convert it to gray</span></span><br><span class="line">    cvtColor( circleImage, src_gray, <span class="type">CV_BGR2GRAY</span> );</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Reduce the noise so we avoid false circle detection</span></span><br><span class="line">    <span class="type">GaussianBlur</span>( src_gray, src_gray, cv::<span class="type">Size</span>(<span class="number">9</span>, <span class="number">9</span>), <span class="number">2</span>, <span class="number">2</span> );</span><br><span class="line">    </span><br><span class="line">    std::vector&lt;cv::<span class="type">Vec3f</span>&gt; circles;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Apply the Hough Transform to find the circles</span></span><br><span class="line">    <span class="type">HoughCircles</span>( src_gray, circles, <span class="type">CV_HOUGH_GRADIENT</span>, <span class="number">1</span>, src_gray.rows/<span class="number">8</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Draw the circles detected</span></span><br><span class="line">    <span class="keyword">for</span>( size_t i = <span class="number">0</span>; i &lt; circles.size(); i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        cv::<span class="type">Point</span> center(cvRound(circles[i][<span class="number">0</span>]), cvRound(circles[i][<span class="number">1</span>]));</span><br><span class="line">        int radius = cvRound(circles[i][<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">// circle center</span></span><br><span class="line">        circle( circleImage, center, <span class="number">3</span>, cv::<span class="type">Scalar</span>(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>,<span class="number">255</span>), -<span class="number">1</span>, <span class="number">8</span>, <span class="number">0</span> );</span><br><span class="line">        <span class="comment">// circle outline</span></span><br><span class="line">        circle( circleImage, center, radius, cv::<span class="type">Scalar</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>), <span class="number">3</span>, <span class="number">8</span>, <span class="number">0</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// Show your results</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">MatToUIImage</span>(circleImage);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h3 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">UIImage</span> *img = [<span class="type">UIImage</span> imageNamed:@<span class="string">"888.JPG"</span>];</span><br><span class="line">    _myImgView.image = img;</span><br><span class="line">    _detectImgView.image = [<span class="type">OpenCVUtil</span> faceDetectForImage:img];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/28/iOSä¸­åŸºäºOpenCVçš„äººè„¸è¯†åˆ«/" class="archive-article-date">
  	<time datetime="2016-11-28T01:45:27.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenCV/">OpenCV</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/äººè„¸è¯†åˆ«/">äººè„¸è¯†åˆ«</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-RecyclerViewä¸­CardViewçš„å±•å¼€ä¸å èµ·" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/23/RecyclerViewä¸­CardViewçš„å±•å¼€ä¸å èµ·/">RecyclerViewä¸­CardViewçš„å±•å¼€ä¸å èµ·</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>RecyclerViewä¸­CardViewçš„å±•å¼€ä¸å èµ·æ•ˆæœã€‚</p>
</blockquote>
<h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h3><p><img src="http://7xoz39.com1.z0.glb.clouddn.com/recyclerflex.png" alt=""></p>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p><a href="https://github.com/zhangzhaopds/FlexbleCell.git" target="_blank" rel="external">æœ¬æ–‡DEMO https://github.com/zhangzhaopds/FlexbleCell.git</a></p>
<p>ä¸»è¦ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">MyAdapter</span>.<span class="title">MyViewHolder</span>&gt; <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(MyViewHolder holder, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</span><br><span class="line">        View cell = LayoutInflater.from(parent.getContext()).inflate(R.layout.cell_main_recyclerview, parent, <span class="keyword">false</span>);</span><br><span class="line">        MyViewHolder myViewHolder = <span class="keyword">new</span> MyViewHolder(cell);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹æ¯ä¸€ä¸ªcellæ³¨å†Œç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">        cell.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å–æ¶ˆviewHolderçš„é‡ç”¨æœºåˆ¶ï¼ˆå¾ˆé‡è¦ï¼‰</span></span><br><span class="line">        myViewHolder.setIsRecyclable(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> myViewHolder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        MyViewHolder(View view) &#123;</span><br><span class="line">            <span class="keyword">super</span>(view);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> index;</span><br><span class="line">		<span class="comment">// å°½é‡ç”¨çº¿æ€§å‚ç›´å¸ƒå±€æ¥åŠ¨æ€çš„æ·»åŠ è§†å›¾</span></span><br><span class="line">        LinearLayout linearLayout = (LinearLayout)v.findViewById(R.id.cell_main_rootLayout);</span><br><span class="line">        View subView = LayoutInflater.from(v.getContext()).inflate(R.layout.cell_main_recyclerview_add, (ViewGroup)v, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ©ç”¨cellæ§ä»¶çš„Tagå€¼æ¥æ ‡è®°cellæ˜¯å¦è¢«ç‚¹å‡»è¿‡,å› ä¸ºå·²ç»å°†é‡ç”¨æœºåˆ¶å–æ¶ˆï¼Œcellé€€å‡ºå½“å‰ç•Œé¢æ—¶å°±ä¼šè¢«é”€æ¯ï¼ŒTagå€¼ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚</span></span><br><span class="line">        <span class="comment">// å¦‚æœä¸å–æ¶ˆé‡ç”¨ï¼Œé‚£ä¹ˆå°†ä¼šå‡ºç°æœªæ›¾ç‚¹å‡»å°±å·²ç»æ·»åŠ å­è§†å›¾çš„æ•ˆæœï¼Œå†ç‚¹å‡»çš„æ—¶å€™ä¼šç»§ç»­æ·»åŠ è€Œä¸æ˜¯æ”¶å›ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (v.findViewById(R.id.cell_main_rootLayout).getTag() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            index = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            index = (<span class="keyword">int</span>)v.findViewById(R.id.cell_main_rootLayout).getTag();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// closeçŠ¶æ€: æ·»åŠ è§†å›¾</span></span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">1</span>) &#123;</span><br><span class="line">            linearLayout.addView(subView);</span><br><span class="line">            subView.setTag(<span class="number">1000</span>);</span><br><span class="line">            v.findViewById(R.id.cell_main_rootLayout).setTag(<span class="number">2</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// opençŠ¶æ€ï¼š ç§»é™¤è§†å›¾</span></span><br><span class="line">            linearLayout.removeView(v.findViewWithTag(<span class="number">1000</span>));</span><br><span class="line">            v.findViewById(R.id.cell_main_rootLayout).setTag(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/23/RecyclerViewä¸­CardViewçš„å±•å¼€ä¸å èµ·/" class="archive-article-date">
  	<time datetime="2016-11-23T08:22:03.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-23</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CardView/">CardView</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/recyclerView/">recyclerView</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ä¾æ‰˜AlertDialogå®ç°çš„iOSé£æ ¼çš„æé†’æ¡†" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/18/ä¾æ‰˜AlertDialogå®ç°çš„iOSé£æ ¼çš„æé†’æ¡†/">ä¾æ‰˜AlertDialogå®ç°çš„iOSé£æ ¼çš„æé†’æ¡†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ç¬¬ä¸€ä¸ªAndroidé¡¹ç›®åŸºæœ¬åšå®Œäº†ï¼Œæ•´ç†ä¸€ä¸‹ç¬”è®°ã€‚ä¸ªäººå®åœ¨æ˜¯æ¬£èµä¸åŠ¨Androidæé†’æ¡†çš„å®¡ç¾é£æ ¼ï¼Œæ‰€ä»¥å°±è‡ªå·±ç®€å•å°è£…ä¸ªï¼Œæ–¹ä¾¿ä»Šåä½¿ç”¨ã€‚</p>
</blockquote>
<p>æ•ˆæœå›¾ï¼š</p>
<p><img src="http://7xoz39.com1.z0.glb.clouddn.com/alertdialog.png" alt=""></p>
<h3 id="å…·ä½“å®ç°ï¼š"><a href="#å…·ä½“å®ç°ï¼š" class="headerlink" title="å…·ä½“å®ç°ï¼š"></a>å…·ä½“å®ç°ï¼š</h3><p>åŸºæœ¬åŸç†ï¼š</p>
<p> åˆ©ç”¨Androidç°æœ‰çš„æé†’æ¡†AlertDialogï¼Œè‡ªå®šä¹‰å†…å®¹è§†å›¾ã€‚</p>
<p>ç›¸å…³ä»£ç ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CustomAlertView<span class="class">.java</span> æ˜¯å¯¹æé†’æ¡†çš„å°è£…ï¼›</span><br><span class="line">view_alert<span class="class">.xml</span> æ˜¯è‡ªå®šä¹‰çš„å†…å®¹è§†å›¾ï¼›</span><br></pre></td></tr></table></figure>
<p>æ–‡ä»¶view_alert.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">    <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"125dp"</span></span><br><span class="line">        <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span></span><br><span class="line">        <span class="attribute">android:layout_centerInParent</span>=<span class="value">"true"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/alert_title"</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></span><br><span class="line">            <span class="attribute">android:text</span>=<span class="value">"æç¤º"</span></span><br><span class="line">            <span class="attribute">android:textAlignment</span>=<span class="value">"center"</span></span><br><span class="line">            <span class="attribute">android:textColor</span>=<span class="value">"@android:color/black"</span></span><br><span class="line">            <span class="attribute">android:gravity</span>=<span class="value">"bottom"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/alert_content"</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></span><br><span class="line">            <span class="attribute">android:text</span>=<span class="value">"è¿™ä¸ªæ˜¯æé†’å†…å®¹"</span></span><br><span class="line">            <span class="attribute">android:textAlignment</span>=<span class="value">"center"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">View</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"0.3dp"</span></span><br><span class="line">            <span class="attribute">android:background</span>=<span class="value">"#e5e5e5"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></span><br><span class="line">            <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">Button</span></span><br><span class="line">                <span class="attribute">android:id</span>=<span class="value">"@+id/alert_leftBtn"</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></span><br><span class="line">                <span class="attribute">android:text</span>=<span class="value">"å–æ¶ˆ"</span></span><br><span class="line">                <span class="attribute">android:gravity</span>=<span class="value">"center"</span></span><br><span class="line">                <span class="attribute">android:textColor</span>=<span class="value">"@android:color/holo_blue_light"</span></span><br><span class="line">                <span class="attribute">android:background</span>=<span class="value">"@android:color/transparent"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">View</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"0.3dp"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:background</span>=<span class="value">"#e5e5e5"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">Button</span></span><br><span class="line">                <span class="attribute">android:id</span>=<span class="value">"@+id/alert_rightBtn"</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">                <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></span><br><span class="line">                <span class="attribute">android:text</span>=<span class="value">"ç¡®å®š"</span></span><br><span class="line">                <span class="attribute">android:gravity</span>=<span class="value">"center"</span></span><br><span class="line">                <span class="attribute">android:textColor</span>=<span class="value">"@android:color/holo_blue_light"</span></span><br><span class="line">                <span class="attribute">android:background</span>=<span class="value">"@android:color/transparent"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ–‡ä»¶CustomAlertView.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomAlertView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TextView alertTitle;</span><br><span class="line">    <span class="keyword">private</span> TextView alertContent;</span><br><span class="line">    <span class="keyword">private</span> Button alertLeftBtn;</span><br><span class="line">    <span class="keyword">private</span> Button alertRightBtn;</span><br><span class="line">    <span class="keyword">private</span> Context mContent;</span><br><span class="line">    <span class="keyword">private</span> AlertDialog alertDialog;</span><br><span class="line">    <span class="keyword">private</span> View mView;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LeftButtonClickedListener leftButtonClickedListener;</span><br><span class="line">    <span class="keyword">public</span> RightButtonClickedListener rightButtonClickedListener;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomAlertView</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">        mContent = context;</span><br><span class="line">        initView(mContent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomAlertView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        mContent = context;</span><br><span class="line">        initView(mContent);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomAlertView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">        mContent = context;</span><br><span class="line">        initView(mContent);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è§†å›¾</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        mView = LayoutInflater.from(mContent).inflate(R.layout.view_alert, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        alertTitle = (TextView)mView.findViewById(R.id.alert_title);</span><br><span class="line">        alertContent = (TextView)mView.findViewById(R.id.alert_content);</span><br><span class="line">        alertLeftBtn = (Button)mView.findViewById(R.id.alert_leftBtn);</span><br><span class="line">        alertRightBtn = (Button)mView.findViewById(R.id.alert_rightBtn);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–AlertDialog</span></span><br><span class="line">        alertDialog = <span class="keyword">new</span> AlertDialog.Builder(mContent).create();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç›‘å¬</span></span><br><span class="line">        alertLeftBtn.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                leftButtonClickedListener.onClickedLeftButton(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        alertRightBtn.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                rightButtonClickedListener.onClickedRightButton(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®å†…å®¹å’Œæ ‡é¢˜</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">baseConfiguration</span><span class="params">(String title, String content)</span> </span>&#123;</span><br><span class="line">        alertTitle.setText(title);</span><br><span class="line">        alertContent.setText(content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼¹å‡ºå¯¹è¯æ¡†</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showAlert</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»¥AlertDialogä¸ºè½½ä½“</span></span><br><span class="line">        alertDialog.setView(mView);</span><br><span class="line">        alertDialog.show();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å®½åº¦ï¼ŒAlertDialogé»˜è®¤çš„å®½åº¦è¿‡äºå¤¸å¼ ã€‚ï¼ˆå¯ä»¥ä¸ä¿®æ”¹ï¼‰</span></span><br><span class="line">        WindowManager windowManager = (WindowManager) getContext().getApplicationContext().getSystemService(Context.WINDOW_SERVICE);</span><br><span class="line">        Display display = windowManager.getDefaultDisplay();</span><br><span class="line">        WindowManager.LayoutParams layoutParams = alertDialog.getWindow().getAttributes();</span><br><span class="line">        layoutParams.width = (<span class="keyword">int</span>)(display.getWidth() * <span class="number">2</span> / <span class="number">3</span>);</span><br><span class="line">        alertDialog.getWindow().setAttributes(layoutParams);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å–æ¶ˆå¯¹è¯æ¡†</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dismissAlert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        alertDialog.dismiss();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LeftButtonClickedListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onClickedLeftButton</span><span class="params">(View view)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RightButtonClickedListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onClickedRightButton</span><span class="params">(View view)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLeftButtonClickedListener</span><span class="params">(LeftButtonClickedListener leftButtonClickedListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.leftButtonClickedListener = leftButtonClickedListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRightButtonClickedListener</span><span class="params">(RightButtonClickedListener rightButtonClickedListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.rightButtonClickedListener = rightButtonClickedListener;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨Activityä¸­çš„è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">        <span class="keyword">final</span> CustomAlertView customAlertView = <span class="keyword">new</span> CustomAlertView(MainActivity.<span class="keyword">this</span>);</span><br><span class="line">        customAlertView.baseConfiguration(<span class="string">"æç¤º"</span>, <span class="string">"ä»Šå¤©æ˜¯æ˜ŸæœŸäº”å—"</span>);</span><br><span class="line"></span><br><span class="line">        Button showBtn = (Button)findViewById(R.id.main_show_btn);</span><br><span class="line">        showBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// æ˜¾ç°</span></span><br><span class="line">                Log.i(TAG, <span class="string">"onClick: æ˜¾ç°"</span>);</span><br><span class="line">                customAlertView.showAlert();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        customAlertView.setLeftButtonClickedListener(<span class="keyword">new</span> CustomAlertView.LeftButtonClickedListener() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClickedLeftButton</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// å–æ¶ˆ</span></span><br><span class="line">                Log.i(TAG, <span class="string">"onClickedLeftButton: å–æ¶ˆ"</span>);</span><br><span class="line">                customAlertView.dismissAlert();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        customAlertView.setRightButtonClickedListener(<span class="keyword">new</span> CustomAlertView.RightButtonClickedListener() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClickedRightButton</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// ç¡®å®š</span></span><br><span class="line">                Log.i(TAG, <span class="string">"onClickedRightButton: ç¡®å®š"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">/** æ­¤å¤„å¤„ç†ä¸€äº›äº‹ç‰© **/</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// å–æ¶ˆ</span></span><br><span class="line">                customAlertView.dismissAlert();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/18/ä¾æ‰˜AlertDialogå®ç°çš„iOSé£æ ¼çš„æé†’æ¡†/" class="archive-article-date">
  	<time datetime="2016-11-18T07:40:28.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-18</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AlertDialog/">AlertDialog</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æé†’æ¡†/">æé†’æ¡†</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-hexoä¸»é¢˜yiliaçš„å¤´åƒæ— æ³•æ˜¾ç°" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/18/hexoä¸»é¢˜yiliaçš„å¤´åƒæ— æ³•æ˜¾ç°/">hexoä¸»é¢˜yiliaçš„å¤´åƒæ— æ³•æ˜¾ç°</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ä¸€ç›´æ‡’å¾—æ•´ç†åšå®¢ï¼Œæ—§ç‰ˆçš„yiliaä¸»é¢˜çš„å¤´åƒæ— æ³•æ˜¾ç°ã€‚</p>
</blockquote>
<h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>åœ¨è·¯å¾„ <code>yilia/layout/_partial/left-col.ejs</code> ä¸‹ï¼Œæ‰“å¼€ left-col.ejs;</p>
<p>ä¿®æ”¹ç¬¬6ã€8è¡Œçš„ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;img lazy-src=&#34;&#60;%=theme.avatar%&#62;&#34; class=&#34;js-avatar &#34;&#62;&#10;&#60;img src=&#34;&#60;%=theme.avatar%&#62;&#34; class=&#34;js-avatar &#34; style=&#34;width: 100%;height: 100%;opacity: 1;&#34;&#62;</span><br></pre></td></tr></table></figure>
<p>ä¸ºï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;img src=&#34;&#60;%=theme.avatar%&#62;&#34; class=&#34;js-avatar show&#34;&#62;&#10;&#60;img src=&#34;&#60;%=theme.avatar%&#62;&#34; class=&#34;js-avatar show&#34; style=&#34;width: 100%;height: 100%;opacity: 1;&#34;&#62;</span><br></pre></td></tr></table></figure>
<p>æœ€åé‡æ–°éƒ¨ç½²å°±è¡Œäº†ã€‚</p>
<p>æœ€æ–°çš„yiliaä¸»é¢˜æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/18/hexoä¸»é¢˜yiliaçš„å¤´åƒæ— æ³•æ˜¾ç°/" class="archive-article-date">
  	<time datetime="2016-11-18T05:50:17.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-18</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/yilia/">yilia</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-MQTT-Android" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/01/MQTT-Android/">MQTT_Android</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>MQTTåœ¨Androidä¸­çš„ä½¿ç”¨ï¼Œå®¢æˆ·ç«¯çš„ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<p>å®˜æ–¹æ–‡æ¡£ <a href="https://github.com/eclipse/paho.mqtt.android" target="_blank" rel="external">https://github.com/eclipse/paho.mqtt.android</a></p>
<h3 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="string">'org.eclipse.paho:org.eclipse.paho.client.mqttv3:1.1.0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//compile 'org.eclipse.paho:org.eclipse.paho.android.service:1.0.2@arr'</span></span><br><span class="line"></span><br><span class="line">compile <span class="string">'org.greenrobot:eventbus:3.0.0'</span></span><br></pre></td></tr></table></figure>
<p>æ·»åŠ å®Œä¹‹åï¼Œå¯èƒ½ä¼šå‡ºç°warning:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ignoring innerclasses attribute <span class="keyword">for</span> an anonymous inner <span class="class"><span class="keyword">class</span></span></span><br></pre></td></tr></table></figure>
<p>å¤„ç†æ–¹æ³•æ˜¯åœ¨ <code>proguard-rules.pro</code>ï¼Œä¸­æ·»åŠ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-keepattributes InnerClasses</span><br><span class="line"></span><br><span class="line">-keepattributes EnclosingMethod</span><br><span class="line"></span><br><span class="line">-dontoptimize</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé—®é¢˜çš„å¤„ç†å¯å‚è€ƒ  <a href="http://stackoverflow.com/questions/35796144/progaurd-issue-warningignoring-innerclasses-attribute-for-an-anonymous-inner-c" target="_blank" rel="external">http://stackoverflow.com/questions/35796144/progaurd-issue-warningignoring-innerclasses-attribute-for-an-anonymous-inner-c</a></p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>åŸºæœ¬ä½¿ç”¨ï¼Œå¯å‚è€ƒä»¥ä¸‹åšå®¢ï¼Œå¾ˆè¯¦ç»†</p>
<p>åšå®¢åœ°å€ï¼š<a href="http://www.longdw.com/mqtt-server-client-android/" target="_blank" rel="external">http://www.longdw.com/mqtt-server-client-android/</a></p>
<p>ä¸‹é¢æ˜¯éƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//hostä¸ºä¸»æœºåï¼Œtestä¸ºclientidå³è¿æ¥MQTTçš„å®¢æˆ·ç«¯IDï¼Œä¸€èˆ¬ä»¥å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦è¡¨ç¤ºï¼ŒMemoryPersistenceè®¾ç½®clientidçš„ä¿å­˜å½¢å¼ï¼Œé»˜è®¤ä¸ºä»¥å†…å­˜ä¿å­˜</span></span><br><span class="line">client = <span class="keyword">new</span> MqttClient(host, <span class="string">"test"</span>,</span><br><span class="line"><span class="keyword">new</span> MemoryPersistence());</span><br><span class="line"><span class="comment">//MQTTçš„è¿æ¥è®¾ç½®</span></span><br><span class="line">options = <span class="keyword">new</span> MqttConnectOptions();</span><br><span class="line"><span class="comment">//è®¾ç½®æ˜¯å¦æ¸…ç©ºsession,è¿™é‡Œå¦‚æœè®¾ç½®ä¸ºfalseè¡¨ç¤ºæœåŠ¡å™¨ä¼šä¿ç•™å®¢æˆ·ç«¯çš„è¿æ¥è®°å½•ï¼Œè¿™é‡Œè®¾ç½®ä¸ºtrueè¡¨ç¤ºæ¯æ¬¡è¿æ¥åˆ°æœåŠ¡å™¨éƒ½ä»¥æ–°çš„èº«ä»½è¿æ¥</span></span><br><span class="line">options.setCleanSession(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//è®¾ç½®è¿æ¥çš„ç”¨æˆ·å</span></span><br><span class="line">options.setUserName(userName);</span><br><span class="line"><span class="comment">//è®¾ç½®è¿æ¥çš„å¯†ç </span></span><br><span class="line">options.setPassword(passWord.toCharArray());</span><br><span class="line"><span class="comment">// è®¾ç½®è¶…æ—¶æ—¶é—´ å•ä½ä¸ºç§’</span></span><br><span class="line">options.setConnectionTimeout(<span class="number">10</span>);</span><br><span class="line"><span class="comment">// è®¾ç½®ä¼šè¯å¿ƒè·³æ—¶é—´ å•ä½ä¸ºç§’ æœåŠ¡å™¨ä¼šæ¯éš”1.5*20ç§’çš„æ—¶é—´å‘å®¢æˆ·ç«¯å‘é€ä¸ªæ¶ˆæ¯åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦åœ¨çº¿ï¼Œä½†è¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰é‡è¿çš„æœºåˆ¶</span></span><br><span class="line">options.setKeepAliveInterval(<span class="number">20</span>);</span><br><span class="line"><span class="comment">//è®¾ç½®å›è°ƒ</span></span><br><span class="line">client.setCallback(<span class="keyword">new</span> MqttCallback() &#123;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connectionLost</span><span class="params">(Throwable cause)</span> </span>&#123;</span><br><span class="line"><span class="comment">//è¿æ¥ä¸¢å¤±åï¼Œä¸€èˆ¬åœ¨è¿™é‡Œé¢è¿›è¡Œé‡è¿</span></span><br><span class="line">System.out.println(<span class="string">"connectionLost----------"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deliveryComplete</span><span class="params">(IMqttDeliveryToken token)</span> </span>&#123;</span><br><span class="line"><span class="comment">//publishåä¼šæ‰§è¡Œåˆ°è¿™é‡Œ</span></span><br><span class="line">System.out.println(<span class="string">"deliveryComplete---------"</span></span><br><span class="line">+ token.isComplete());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">messageArrived</span><span class="params">(String topicName, MqttMessage message)</span></span><br><span class="line"><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"><span class="comment">//subscribeåå¾—åˆ°çš„æ¶ˆæ¯ä¼šæ‰§è¡Œåˆ°è¿™é‡Œé¢</span></span><br><span class="line">System.out.println(<span class="string">"messageArrived----------"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//            connect();</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/01/MQTT-Android/" class="archive-article-date">
  	<time datetime="2016-11-01T05:23:17.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-01</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MQTT/">MQTT</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Compiling" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/21/Compiling/">Compiling Swift source files</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>è‡ªä»é¡¹ç›®æäº¤åˆ°AppStoreä¹‹åï¼Œä¸€ç›´åœ¨å­¦ä¹ Androidçš„ä¸œè¥¿ï¼Œä»Šå¤©å› ä¸ºè¦æ”¹ä¸ªæ¥å£ï¼Œå°±æ‰“å¼€äº†é‚£ä¸ªSwiftç‰ˆæœ¬çš„é¡¹ç›®ï¼Œç»“æœXcodeå°±ä¸€ç›´å¤„äºç¼–è¯‘çŠ¶æ€ <code>Compiling Swift source files</code>ï¼Œç­‰äº†åŠå¤©æ²¡æœ‰ç»“æŸï¼›æˆ‘æŠŠæ–°æ·»åŠ çš„å†…å®¹åˆ é™¤ï¼Œå›å½’åˆ°æäº¤AppStroeæ—¶çš„æ ·å­ï¼Œç¼–è¯‘å¾ˆæ…¢ï¼Œä½†æœ€ç»ˆé€šè¿‡äº†ï¼Œç„¶ååœ¨Command+Rä¹Ÿå¾ˆå¿«ï¼Œå›å½’æ­£å¸¸ã€‚ç„¶åå°±Googleï¼Œé‡åˆ°äº†å„ç§å„æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œä½†çœŸæ²¡é€‚åˆæˆ‘çš„ã€‚</p>
</blockquote>
<p>ã€Compiling Swift source filesã€‘ç¼–è¯‘å¾ˆæ…¢ï¼›</p>
<p>ã€è§£å†³ã€‘Edit Scheme â€”&gt; Build Configurationï¼Œè®¾ç½®ä¸ºã€Debugã€‘</p>
<p>ã€æ€»ç»“ï¼šè‡ªå·±å¾ˆäºŒé€¼ã€‘appæ‰“åŒ…çš„æ—¶å€™å°†BuildConfigurationè®¾ç½®ä¸ºäº†Releaseï¼Œå›å¤´ç»§ç»­ç ä»£ç çš„æ—¶å€™å¿˜äº†è®¾ç½®Debugäº†ï¼Œä¸ºæ­¤ç™½ç™½æµªè´¹äº†2ä¸ªå¤šå°æ—¶ï¼Œå¤ŸäºŒï¼</p>
<p><a href="http://stackoverflow.com/questions/39476239/xcode-build-stuck-on-compiling-swift-source-files" target="_blank" rel="external">ç›¸å…³å‚è€ƒï¼šhttp://stackoverflow.com/questions/39476239/xcode-build-stuck-on-compiling-swift-source-files</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/10/21/Compiling/" class="archive-article-date">
  	<time datetime="2016-10-21T15:26:40.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-10-21</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Compiling/">Compiling</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Swift/">Swift</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Jmsp
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: false
	}
</script>

<script src="/./main.js" type="text/javascript"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
    
    
    
  </ul>
  <div class="tools-wrap">
    

    

    

    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>